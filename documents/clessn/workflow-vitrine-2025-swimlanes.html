<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitrine D√©mocratique - Workflow 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: 2px solid #333;
            background: white;
            color: #333;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn:hover {
            background: #555;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .btn.active {
            background: #333;
            color: white;
        }

        /* Boutons de filtre par type de node */
        .btn-node {
            padding: 8px 16px;
            border: 2px solid #333;
            background: white;
            color: #333;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .node-color-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: inline-block;
            border: 2px solid rgba(0, 0, 0, 0.2);
        }

        .btn-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn-node.active-node {
            opacity: 1;
        }

        .btn-node:not(.active-node) {
            opacity: 0.4;
        }

        .pipeline {
            margin-bottom: 30px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .pipeline.hidden {
            display: none;
        }

        .pipeline-header {
            padding: 20px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .pipeline-header:hover {
            filter: brightness(1.1);
        }

        .pipeline-content {
            background: white;
            padding: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            overflow-x: auto;
            min-height: 150px;
        }

        .pipeline-content::-webkit-scrollbar {
            height: 8px;
        }

        .pipeline-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .pipeline-content::-webkit-scrollbar-thumb {
            background: #999;
            border-radius: 4px;
        }

        .node {
            min-width: 160px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .node:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        }

        .node-refiner {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            border: 3px solid #2E5C8A;
        }

        .node-table {
            background: linear-gradient(135deg, #50C878 0%, #3BA05F 100%);
            color: white;
            border: 3px solid #2D7A4A;
        }

        .node-output {
            background: linear-gradient(135deg, #FFB347 0%, #FF8C00 100%);
            color: white;
            border: 3px solid #CC7000;
        }

        .node-dict {
            background: linear-gradient(135deg, #9B59B6 0%, #7D3C98 100%);
            color: white;
            border: 3px solid #5E2A6F;
        }

        .node-source {
            background: linear-gradient(135deg, #E74C3C 0%, #C0392B 100%);
            color: white;
            border: 3px solid #922B21;
        }

        .arrow {
            font-size: 24px;
            color: #666;
            font-weight: bold;
            flex-shrink: 0;
        }

        .node-schedule {
            font-size: 10px;
            margin-top: 8px;
            opacity: 0.9;
            font-weight: normal;
        }

        .node-detail {
            font-size: 10px;
            margin-top: 5px;
            opacity: 0.85;
            font-weight: normal;
            line-height: 1.4;
        }

        /* Pipeline-specific colors - tous en gris */
        .pipeline-salient .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-issues .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-parties .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-reflet .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-headline .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-hot20 .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-sonar .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-vitrine .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }

        .toggle-icon {
            transition: transform 0.3s;
        }

        .pipeline.collapsed .pipeline-content {
            display: none;
        }

        .pipeline.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .frequency {
            font-size: 11px;
            opacity: 0.9;
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 12px;
            border-radius: 20px;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s;
        }

        .modal-content h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 3px solid #555;
            padding-bottom: 10px;
        }

        .modal-content h3 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .modal-content ul {
            list-style: none;
            padding: 0;
        }

        .modal-content li {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f9fa;
            border-left: 4px solid #555;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .modal-content p {
            line-height: 1.6;
            color: #555;
            margin-bottom: 15px;
        }

        .close-modal {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: #333;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .info-badge {
            display: block;
            background: rgba(255, 255, 255, 0.3);
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-top: 8px;
            cursor: help;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Workflow Vitrine D√©mocratique 2025</h1>
        <p class="subtitle">Architecture compl√®te des pipelines de donn√©es ‚Ä¢ Version interactive 100% valid√©e contre le code (2025-01-13) ‚Ä¢ <a href="https://dev.vitrinedemocratique.com/beta.html" target="_blank" style="color: #4A90E2; text-decoration: none; font-weight: bold;">üåê Voir le site vitrine (DEV)</a></p>

        <div class="controls">
            <button class="btn active" data-filter="all">Voir tous les pipelines</button>
            <button class="btn" data-filter="salient">Salient Objects</button>
            <button class="btn" data-filter="issues">Issues Score</button>
            <button class="btn" data-filter="parties">Party Scores</button>
            <button class="btn" data-filter="reflet">Reflet</button>
            <button class="btn" data-filter="headline">Headline of Headlines</button>
            <button class="btn" data-filter="hot20">Hot 20</button>
            <button class="btn" data-filter="sonar">SONAR</button>
            <button class="btn" data-filter="vitrine">Publication</button>
        </div>

        <!-- Filtres par type de node -->
        <div class="controls" style="margin-top: 10px; margin-bottom: 20px;">
            <button class="btn-node btn-node-refiner active-node" data-node-filter="refiner">
                <span class="node-color-box" style="background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);"></span>
                Refiner (R)
            </button>
            <button class="btn-node btn-node-table active-node" data-node-filter="table">
                <span class="node-color-box" style="background: linear-gradient(135deg, #50C878 0%, #3BA05F 100%);"></span>
                Table Datamart
            </button>
            <button class="btn-node btn-node-output active-node" data-node-filter="output">
                <span class="node-color-box" style="background: linear-gradient(135deg, #FFB347 0%, #FF8C00 100%);"></span>
                Output (JSON/Slack)
            </button>
            <button class="btn-node btn-node-dict active-node" data-node-filter="dict">
                <span class="node-color-box" style="background: linear-gradient(135deg, #9B59B6 0%, #7D3C98 100%);"></span>
                Dictionnaire
            </button>
            <button class="btn-node btn-node-source active-node" data-node-filter="source">
                <span class="node-color-box" style="background: linear-gradient(135deg, #E74C3C 0%, #C0392B 100%);"></span>
                Source Externe
            </button>
        </div>

        <!-- SALIENT OBJECTS (BASE PIPELINE) -->
        <div class="pipeline pipeline-salient" data-pipeline="salient">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üîµ Salient Objects (Pipeline de Base)</span>
                <span class="frequency">6x/jour: 00:03, 04:03, 08:03, 12:03, 16:03, 20:03 UTC (19:03, 23:03, 03:03, 07:03, 11:03, 15:03 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-headlines">
                    r-media-headlines
                    <div class="node-detail">Glue Job Python</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="salient-objects">
                    radar-salient-objects.R
                    <div class="node-schedule">‚è∞ +17min apr√®s Glue</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="salient_headlines_objects">
                    salient_headlines_objects
                    <div class="node-detail">Table des objets saillants</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="salient-index">
                    radar-salient-index.R
                    <div class="node-detail">Calcul indices</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="salient_index">
                    salient_index
                    <div class="node-detail">Indices de saillance</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- ISSUES SCORE -->
        <div class="pipeline pipeline-issues" data-pipeline="issues">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üìä Issues Score (Scores par Enjeu)</span>
                <span class="frequency">Quotidien: 00:15 UTC (19:15 EST veille)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-headlines">
                    r-media-headlines
                    <div class="node-detail">Glue Job Python ETL</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="issues">
                    dict-issues-two-categories
                    <div class="node-detail">12 cat√©gories</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="headlines-issues">
                    radar-headlines-issues.R
                    <div class="node-detail">Classifie headlines</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="headlines_issues">
                    headlines_issues_*
                    <div class="node-detail">day/week/month</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="issues-score">
                    radar-issues-score.R
                    <div class="node-schedule">‚è∞ 00:15 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="issues_score">
                    issues_score_day<br>issues_score_week<br>issues_score_month
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- PARTY SCORES -->
        <div class="pipeline pipeline-parties" data-pipeline="parties">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üèõÔ∏è Party Scores (Mentions Partis Politiques)</span>
                <span class="frequency">Quotidien: 00:30 UTC (19:30 EST veille)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-headlines">
                    r-media-headlines
                    <div class="node-detail">Glue Job Python ETL</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="parties-ca">
                    dict-political-parties-ca
                    <div class="node-detail">Partis f√©d√©raux</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="parties-qc">
                    dict-political-parties-qc
                    <div class="node-detail">Partis provinciaux</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="sentiments">
                    dict-sentiments
                    <div class="node-detail">Analyse de ton</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="party-score">
                    radar-party-score.R
                    <div class="node-schedule">‚è∞ 00:30 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="parties_score">
                    federal_parties_score_*<br>provincial_parties_score_*
                    <div class="node-detail">day/week/month</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- REFLET -->
        <div class="pipeline pipeline-reflet" data-pipeline="reflet">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üí≠ Reflet (Synth√®ses LLM par Enjeu)</span>
                <span class="frequency">Daily: 01:00 UTC (20:00 EST) ‚Ä¢ Monthly: 1er du mois 02:00 UTC (21:00 EST)</span>
            </div>
            <div class="pipeline-content" style="display: grid; grid-template-columns: auto auto auto auto auto auto auto auto auto auto auto auto auto; gap: 15px; align-items: center;">
                <!-- Ligne 1: Daily/Weekly -->
                <div class="node node-table" data-type="table" data-table="headlines_issues_day">
                    headlines_issues_day
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-table" data-type="table" data-table="headlines_issues_week">
                    headlines_issues_week
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="reflet-daily-weekly">
                    radar-reflet-daily-weekly.R
                    <div class="node-schedule">‚è∞ 01:00 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div style="position: relative;">
                    <div class="node node-table" data-type="table" data-table="reflet_day">
                        reflet_day
                        <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                    </div>
                    <!-- Fl√®che verticale depuis ce node -->
                    <div style="position: absolute; top: 100%; left: 50%; transform: translateX(-50%); height: 30px; display: flex; align-items: center;">
                        <div style="font-size: 24px; color: #666; transform: rotate(90deg);">‚Üí</div>
                    </div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-table" data-type="table" data-table="reflet_week">
                    reflet_week
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>

                <!-- Ligne 2: Monthly - utilise grid-column pour alignement exact -->
                <div class="node node-refiner" data-type="refiner" data-refiner="reflet-monthly" style="grid-column: 7; margin-top: 40px;">
                    radar-reflet-monthly.R
                    <div class="node-schedule">‚è∞ 02:00 UTC (1er)</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow" style="grid-column: 8; margin-top: 40px;">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="reflet_month" style="grid-column: 9; margin-top: 40px;">
                    reflet_month
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- HEADLINE OF HEADLINES -->
        <div class="pipeline pipeline-headline" data-pipeline="headline">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üì∞ Headline of Headlines (Une des Unes)</span>
                <span class="frequency">6x/jour: +55min apr√®s Glue</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="salient_headlines_objects">
                    salient_headlines_objects
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-table" data-type="table" data-table="salient_index">
                    salient_index
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="headline-of-headlines">
                    radar-headline-of-headlines.R
                    <div class="node-detail">Synth√®se LLM</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="headline_of_headlines">
                    headline_of_headlines
                    <div class="node-detail">Une par p√©riode 4h</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- HOT 20 -->
        <div class="pipeline pipeline-hot20" data-pipeline="hot20">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üî• RADAR+ Hot 20 (TOP 20 Hebdomadaire)</span>
                <span class="frequency">Vendredis: 17:00 UTC (12:00 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="salient_headlines_objects">
                    salient_headlines_objects
                    <div class="node-detail">Semaine compl√®te</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="hot20">
                    radar-hot-20.R
                    <div class="node-schedule">‚è∞ Ven 17:00</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="hot_20_headlines">
                    hot_20_headlines
                    <div class="node-detail">3 pays</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="hot20-files">
                    6 PNG + 6 HTML
                    <div class="node-detail">QC, CAN, USA √ó 2</div>
                    <div class="info-badge">üñºÔ∏è Cliquer pour voir exemples</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="slack-hot20">
                    Slack: hot20
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
            </div>
        </div>

        <!-- SONAR -->
        <div class="pipeline pipeline-sonar" data-pipeline="sonar">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üì° SONAR Heatmaps (Monitoring Qualit√©)</span>
                <span class="frequency">Mercredis: 09:00 UTC (04:00 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-frontpages">
                    r-media-frontpages
                    <div class="node-detail">Glue Job Python</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="sonar">
                    sonar.R
                    <div class="node-detail">Extrait donn√©es SONAR</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="data_quality_14_days">
                    data_quality_14_days
                    <div class="node-detail">Datamart: sonar</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="sonar-heatmaps">
                    sonar-heatmaps.R
                    <div class="node-schedule">‚è∞ Mer 09:00</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="sonar-heatmaps">
                    Heatmaps PNG + HTML
                    <div class="info-badge">üñºÔ∏è Cliquer pour voir exemples</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="slack-sonar">
                    Slack: sonar
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
            </div>
        </div>

        <!-- PUBLICATION VITRINE -->
        <div class="pipeline pipeline-vitrine" data-pipeline="vitrine">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üì§ Publication Vitrine (JSON vers S3 Frontend)</span>
                <span class="frequency">5x/jour: 00:39, 04:39, 08:39, 12:39, 16:39, 20:39 UTC</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="all-final-tables">
                    Toutes les tables finales
                    <div class="node-detail">issues_score_*, parties_score_*, reflet_*, headline_of_headlines</div>
                    <div class="info-badge">üìã Cliquer pour liste compl√®te</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="vitrine-graph-data">
                    vitrine-graph-data.R
                    <div class="node-schedule">‚è∞ 5x/jour +36min</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="json-files">
                    13 fichiers JSON
                    <div class="node-detail">Publi√©s sur S3</div>
                    <div class="info-badge">üìÑ Cliquer pour liste des fichiers</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" style="min-width: 200px;" data-type="output" data-output="frontend-vitrine">
                    Frontend Vitrine
                    <div class="node-detail">Site web public vitrine d√©mocratique</div>
                    <div class="info-badge">üåê Cliquer pour ouvrir site</div>
                </div>
            </div>
        </div>

    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        // Modal data
        const modalData = {
            tables: {
                'salient_headlines_objects': {
                    title: 'Table: salient_headlines_objects',
                    description: 'Table principale contenant les headlines et leurs objets saillants extraits',
                    columns: [
                        'media_id - Identifiant du m√©dia',
                        'country_id - Pays (CAN, USA)',
                        'language - Langue du headline',
                        'headline_start_montreal_tz - D√©but du headline (heure Montr√©al)',
                        'headline_stop_montreal_tz - Fin du headline (heure Montr√©al)',
                        'headline_start_utc - D√©but du headline (UTC)',
                        'headline_stop_utc - Fin du headline (UTC)',
                        'headline_minutes - Dur√©e du headline en minutes',
                        'headline_prop - Proportion de la p√©riode',
                        'title - Titre du headline',
                        'body - Corps du texte',
                        'author - Auteur',
                        'url - URL de l\'article',
                        'extracted_objects - Objets saillants extraits (CSV)',
                        'time_interval_montreal_tz - Intervalle 4h (Montr√©al)',
                        'time_interval_utc - Intervalle 4h (UTC)',
                        'prompt - Prompt utilis√© pour extraction LLM',
                        'conversation - Conversation compl√®te (JSON)',
                        'response - R√©ponse LLM (JSON)',
                        'tag - Version/timestamp des donn√©es'
                    ]
                },
                'salient_index': {
                    title: 'Table: salient_index',
                    description: 'Indices de saillance absolus par objet et p√©riode 4h (valid√© depuis radar-salient-index.R)',
                    columns: [
                        'country_id - Pays (CAN, USA)',
                        'date_utc - Date (UTC)',
                        'time_interval_utc - Intervalle 4h UTC (00-04, 04-08, 08-12, 12-16, 16-20, 20-24)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'time_interval_montreal_tz - Intervalle 4h Montr√©al',
                        'extracted_objects - Nom objet saillant (normalis√© lowercase, sans ponctuation)',
                        'n - Nombre d\'occurrences de l\'objet',
                        'total_minutes_objet - Somme du temps en Une (minutes)',
                        'total_pond_time - Somme pond√©r√©e intra-m√©dia',
                        'total_pond_time_norm - Somme pond√©r√©e inter-m√©dias',
                        'absolute_normalized_index - Indice saillance absolu (n √ó total_pond_time_norm)',
                        'n_titles - Nombre de titres uniques',
                        'n_bodies - Nombre de textes uniques',
                        'urls - Liste URLs (JSON)',
                        'titles - Liste titres (JSON)',
                        'bodies - Liste textes complets (JSON)'
                    ]
                },
                'headlines_issues_day': {
                    title: 'Table: headlines_issues_day',
                    description: 'Headlines classifi√©s par enjeux - format quotidien (valid√© depuis radar-headlines-issues.R)',
                    columns: [
                        'date_utc - Date (UTC)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'issue - Enjeu identifi√© (snake_case, ex: economy_and_labour)',
                        'body - Phrase/texte du headline classifi√© sous cet enjeu',
                        'pass - P√©riode (am/pm) - uniquement pour _day'
                    ]
                },
                'headlines_issues_week': {
                    title: 'Table: headlines_issues_week',
                    description: 'Headlines classifi√©s par enjeux - format hebdomadaire (valid√© depuis radar-headlines-issues.R)',
                    columns: [
                        'date_utc - Date (UTC)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'issue - Enjeu identifi√© (snake_case, ex: economy_and_labour)',
                        'body - Phrase/texte du headline classifi√© sous cet enjeu'
                    ]
                },
                'headlines_issues_month': {
                    title: 'Table: headlines_issues_month',
                    description: 'Headlines classifi√©s par enjeux - format mensuel (valid√© depuis radar-headlines-issues.R)',
                    columns: [
                        'date_utc - Date (UTC)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'issue - Enjeu identifi√© (snake_case, ex: economy_and_labour)',
                        'body - Phrase/texte du headline classifi√© sous cet enjeu'
                    ]
                },
                'issues_score': {
                    title: 'Tables: issues_score_*',
                    description: 'Proportions agr√©g√©es par enjeu - somme √† 1.0 (valid√© depuis radar-issues-score.R)',
                    columns: [
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'date_utc - Date (UTC)',
                        'economy_and_labour - Proportion enjeu √©conomie (0-1)',
                        'rights_liberties_minorities_discrimination - Proportion droits/libert√©s (0-1)',
                        'health_and_social_services - Proportion sant√© (0-1)',
                        'public_lands_and_agriculture - Proportion territoires/agriculture (0-1)',
                        'immigration - Proportion immigration (0-1)',
                        'education - Proportion √©ducation (0-1)',
                        'environment_and_energy - Proportion environnement/√©nergie (0-1)',
                        'law_and_crime - Proportion loi/crime (0-1)',
                        'international_affairs_and_defense - Proportion affaires internationales (0-1)',
                        'technology - Proportion technologie (0-1)',
                        'governments_and_governance - Proportion gouvernance (0-1)',
                        'culture_and_nationalism - Proportion culture/nationalisme (0-1)',
                        'pass - P√©riode (am/pm) - uniquement pour _day, absent pour week/month'
                    ]
                },
                'parties_score': {
                    title: 'Tables: *_parties_score_*',
                    description: 'Mentions et ton pond√©r√©s par parti politique (valid√© depuis radar-party-score.R)',
                    columns: [
                        'party - Nom parti (lpc/cpc/ndp/bq/gpc/ppc pour f√©d√©ral | caq/pq/plq/qs/pcq pour provincial)',
                        'weighted_mentions - Mentions pond√©r√©es (nombre d√©cimal)',
                        'weighted_tone - Ton pond√©r√© positif/n√©gatif (nombre d√©cimal)',
                        'date_utc - Date la plus r√©cente de la p√©riode',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'pass - P√©riode (am/pm) - uniquement pour _day, absent pour week/month'
                    ]
                },
                'reflet_day': {
                    title: 'Table: reflet_day',
                    description: 'Synth√®ses quotidiennes LLM par enjeu (valid√© depuis radar-reflet-daily-weekly.R)',
                    columns: [
                        'issue - Enjeu trait√© (snake_case, ex: economy_and_labour)',
                        'summary - R√©sum√© g√©n√©r√© par LLM (texte, liste de points cl√©s)',
                        'date_utc - Date (UTC)',
                        'pass - P√©riode (am/pm)'
                    ]
                },
                'reflet_week': {
                    title: 'Table: reflet_week',
                    description: 'Synth√®ses hebdomadaires LLM (valid√© depuis radar-reflet-daily-weekly.R)',
                    columns: [
                        'issue - Enjeu trait√©',
                        'summary - R√©sum√© hebdomadaire LLM',
                        'date_utc - Date de fin de semaine'
                    ]
                },
                'reflet_month': {
                    title: 'Table: reflet_month',
                    description: 'Synth√®ses mensuelles LLM (valid√© depuis radar-reflet-monthly.R)',
                    columns: [
                        'issue - Enjeu trait√©',
                        'summary - R√©sum√© mensuel LLM',
                        'date_utc - Date de fin de mois'
                    ]
                },
                'headline_of_headlines': {
                    title: 'Table: headline_of_headlines',
                    description: 'Une des Unes par p√©riode 4h - synth√®se LLM (valid√© depuis radar-headline-of-headlines.R)',
                    columns: [
                        'country_id - Pays (CAN, USA)',
                        'date_utc - Date (UTC)',
                        'time_interval_utc - Intervalle 4h UTC (00-04, 04-08, 08-12, 12-16, 16-20, 20-24)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'time_interval_montreal_tz - Intervalle 4h Montr√©al',
                        'main_issue - Enjeu principal (snake_case, ex: economy_and_labour)',
                        'main_issue_text_fr - Texte enjeu fran√ßais (ex: "√âconomie et travail")',
                        'main_issue_text_en - Texte enjeu anglais (ex: "Economy and labour")',
                        'title - Titre g√©n√©r√© par LLM (nettoy√© des * et # cons√©cutifs)',
                        'text - Texte du headline g√©n√©r√© par LLM',
                        'objects - Objets saillants principaux (JSON string)',
                        'conversation - Conversation LLM compl√®te (JSON)',
                        'response - R√©ponse LLM brute (JSON)',
                        'prompt - Prompt utilis√© pour g√©n√©ration LLM'
                    ]
                },
                'hot_20_headlines': {
                    title: 'Table: hot_20_headlines',
                    description: 'TOP 20 des headlines hebdomadaires pour QC, CAN, USA',
                    columns: [
                        'country_id - Pays (QC, CAN, USA)',
                        'week_end_date - Date de fin de semaine',
                        'rank - Rang (1-20)',
                        'title - Titre du headline',
                        'url - URL',
                        'media_id - M√©dia source',
                        'salience_score - Score de saillance',
                        'mention_count - Nombre de mentions'
                    ]
                },
                'data_quality_14_days': {
                    title: 'Table: data_quality_14_days',
                    description: 'Donn√©es de qualit√© SONAR sur 14 jours (datamart: sonar)',
                    columns: [
                        'date - Date',
                        'media_id - Identifiant m√©dia',
                        'country_id - Pays',
                        'scraping_success - Taux de succ√®s scraping',
                        'data_completeness - Compl√©tude des donn√©es',
                        'error_count - Nombre d\'erreurs',
                        'quality_score - Score qualit√© global'
                    ]
                }
            },
            refiners: {
                'salient-objects': {
                    title: 'Refiner: radar-salient-objects.R',
                    description: 'Extrait les objets saillants (personnes, organisations, lieux) des headlines en utilisant un LLM.',
                    details: [
                        'Lit les headlines bruts de r-media-headlines',
                        'Calcule les dur√©es de Une pour chaque headline',
                        'Utilise ellipsellm pour extraire les objets saillants',
                        'Cr√©e des intervalles de 4h (Montr√©al et UTC)',
                        'Publie dans vitrine_datamart.salient_headlines_objects',
                        'Ex√©cution: 6x/jour (+17min apr√®s Glue Job)'
                    ]
                },
                'salient-index': {
                    title: 'Refiner: radar-salient-index.R',
                    description: 'Calcule les indices de saillance pour chaque objet extrait.',
                    details: [
                        'Lit salient_headlines_objects',
                        'Compte les mentions par objet et par m√©dia',
                        'Calcule un score de saillance pond√©r√©',
                        'Agr√®ge par intervalle temporel',
                        'Publie dans vitrine_datamart.salient_index',
                        'Utilis√© par radar-headline-of-headlines'
                    ]
                },
                'headlines-issues': {
                    title: 'Refiner: radar-headlines-issues.R',
                    description: 'Classifie chaque headline selon 12 cat√©gories d\'enjeux avec scores de confiance.',
                    details: [
                        'Lit salient_headlines_objects',
                        'Utilise dict-issues-two-categories (12 cat√©gories)',
                        'Applique mod√®le de classification par enjeu',
                        'G√©n√®re scores de confiance par cat√©gorie',
                        'Publie headlines_issues_day/week/month',
                        'Base pour issues-score et reflet'
                    ]
                },
                'issues-score': {
                    title: 'Refiner: radar-issues-score.R',
                    description: 'Agr√®ge les scores d\'enjeux par p√©riode (quotidien, hebdomadaire, mensuel).',
                    details: [
                        'Lit headlines_issues_*',
                        'Calcule moyennes pond√©r√©es par p√©riode',
                        'G√©n√®re 3 tables: _day, _week, _month',
                        'Publie dans vitrine_datamart',
                        'Ex√©cution: Quotidien 00:15 UTC (19:15 EST)',
                        'Utilis√© par vitrine-graph-data pour frontend'
                    ]
                },
                'party-score': {
                    title: 'Refiner: radar-party-score.R',
                    description: 'Analyse les mentions de partis politiques et calcule le ton des headlines.',
                    details: [
                        'Lit salient_headlines_objects',
                        'Utilise dict-political-parties-ca (f√©d√©ral)',
                        'Utilise dict-political-parties-qc (provincial)',
                        'Utilise dict-sentiments pour analyse de ton',
                        'Calcule mentions pond√©r√©es et ton moyen',
                        'G√©n√®re federal/provincial √ó day/week/month (6 tables)',
                        'Ex√©cution: Quotidien 00:30 UTC (19:30 EST)'
                    ]
                },
                'reflet-daily-weekly': {
                    title: 'Refiner: radar-reflet-daily-weekly.R',
                    description: 'G√©n√®re des synth√®ses textuelles (LLM) quotidiennes et hebdomadaires par enjeu.',
                    details: [
                        'Lit salient_headlines_objects et headlines_issues_*',
                        'Pour chaque enjeu principal:',
                        '  ‚Ä¢ S√©lectionne headlines pertinents',
                        '  ‚Ä¢ Utilise ellipsellm pour g√©n√©rer r√©sum√©',
                        '  ‚Ä¢ Format: liste de points cl√©s',
                        'Publie reflet_day et reflet_week',
                        'Envoie notifications Slack',
                        'Ex√©cution: Quotidien 01:00 UTC (20:00 EST)'
                    ]
                },
                'reflet-monthly': {
                    title: 'Refiner: radar-reflet-monthly.R',
                    description: 'G√©n√®re des synth√®ses textuelles mensuelles par enjeu.',
                    details: [
                        'M√™me logique que reflet-daily-weekly',
                        'Agr√®ge sur un mois complet',
                        'Publie reflet_month',
                        'Envoie notification Slack',
                        'Ex√©cution: 1er du mois 02:00 UTC (21:00 EST)'
                    ]
                },
                'headline-of-headlines': {
                    title: 'Refiner: radar-headline-of-headlines.R',
                    description: 'G√©n√®re un headline synth√®se (Une des Unes) pour chaque p√©riode de 4h utilisant LLM.',
                    details: [
                        'Lit salient_headlines_objects et salient_index',
                        'Identifie les objets les plus saillants',
                        'D√©termine l\'enjeu principal de la p√©riode',
                        'Utilise ellipsellm pour g√©n√©rer:',
                        '  ‚Ä¢ Titre synth√®se',
                        '  ‚Ä¢ Texte descriptif',
                        '  ‚Ä¢ Liste objets principaux',
                        'Publie headline_of_headlines',
                        'Ex√©cution: 6x/jour (+55min apr√®s Glue)'
                    ]
                },
                'hot20': {
                    title: 'Refiner: radar-hot-20.R',
                    description: 'G√©n√®re le TOP 20 des headlines les plus saillants de la semaine pour 3 pays.',
                    details: [
                        'Lit salient_headlines_objects de la semaine',
                        'Calcule scores de saillance par headline',
                        'G√©n√®re TOP 20 pour QC, CAN, USA',
                        'Publie hot_20_headlines',
                        'Cr√©e visualisations GT (PNG + HTML interactif)',
                        'Envoie √† Slack avec images',
                        'Ex√©cution: Vendredis 17:00 UTC (12:00 EST)'
                    ]
                },
                'sonar': {
                    title: 'Refiner: sonar.R',
                    description: 'Extrait et agr√®ge les donn√©es de qualit√© SONAR depuis r-media-frontpages.',
                    details: [
                        'Lit r-media-frontpages (table Glue)',
                        'Analyse qualit√© du scraping par m√©dia',
                        'Calcule m√©triques sur 14 derniers jours',
                        'Publie data_quality_14_days (datamart: sonar)',
                        'Base pour sonar-heatmaps.R'
                    ]
                },
                'sonar-heatmaps': {
                    title: 'Refiner: sonar-heatmaps.R',
                    description: 'G√©n√®re des heatmaps de qualit√© des donn√©es pour monitoring SONAR.',
                    details: [
                        'Lit data_quality_14_days',
                        'Cr√©e heatmaps de qualit√© par m√©dia/jour',
                        'G√©n√®re PNG et HTML interactif',
                        'Publie sur S3',
                        'Envoie √† Slack',
                        'Ex√©cution: Mercredis 09:00 UTC (04:00 EST)'
                    ]
                },
                'vitrine-graph-data': {
                    title: 'Refiner: vitrine-graph-data.R',
                    description: 'Publie toutes les donn√©es finales en JSON vers S3 pour le frontend vitrine.',
                    details: [
                        'Lit TOUTES les tables finales:',
                        '  ‚Ä¢ issues_score_day/week/month',
                        '  ‚Ä¢ federal_parties_score_*',
                        '  ‚Ä¢ provincial_parties_score_*',
                        '  ‚Ä¢ reflet_day/week/month',
                        '  ‚Ä¢ headline_of_headlines',
                        'Convertit en JSON propre',
                        'Publie 13 fichiers sur S3',
                        'Structure: data/refined/{period}/{table}.json',
                        'Ex√©cution: 5x/jour (+36min): 00:39, 04:39, 08:39, 12:39, 16:39, 20:39 UTC'
                    ]
                }
            },
            dicts: {
                'issues': {
                    title: 'Dictionnaire: dict-issues-two-categories',
                    description: 'D√©finit les 12 cat√©gories d\'enjeux politiques utilis√©es pour classifier les headlines.',
                    details: [
                        '1. Economy and Labour (√âconomie et travail)',
                        '2. Rights, Liberties, Minorities & Discrimination',
                        '3. Health and Social Services',
                        '4. Public Lands and Agriculture',
                        '5. Immigration',
                        '6. Education',
                        '7. Environment and Energy',
                        '8. Law and Crime',
                        '9. International Affairs and Defense',
                        '10. Technology',
                        '11. Governments and Governance',
                        '12. Culture and Nationalism'
                    ]
                },
                'parties-ca': {
                    title: 'Dictionnaire: dict-political-parties-ca',
                    description: 'Liste des partis politiques f√©d√©raux canadiens √† suivre.',
                    details: [
                        'Parti Lib√©ral du Canada',
                        'Parti Conservateur du Canada',
                        'Nouveau Parti D√©mocratique (NPD)',
                        'Bloc Qu√©b√©cois',
                        'Parti Vert du Canada',
                        'Parti Populaire du Canada (PPC)',
                        'Inclut noms officiels, abr√©viations, leaders'
                    ]
                },
                'parties-qc': {
                    title: 'Dictionnaire: dict-political-parties-qc',
                    description: 'Liste des partis politiques provinciaux qu√©b√©cois.',
                    details: [
                        'Coalition Avenir Qu√©bec (CAQ)',
                        'Parti Lib√©ral du Qu√©bec (PLQ)',
                        'Parti Qu√©b√©cois (PQ)',
                        'Qu√©bec Solidaire (QS)',
                        'Parti Conservateur du Qu√©bec (PCQ)',
                        'Inclut noms officiels, abr√©viations, leaders'
                    ]
                },
                'sentiments': {
                    title: 'Dictionnaire: dict-sentiments',
                    description: 'Dictionnaire de mots et expressions avec valences de sentiment pour analyse de ton.',
                    details: [
                        'Mots positifs avec scores (+1 √† +5)',
                        'Mots n√©gatifs avec scores (-1 √† -5)',
                        'Expressions idiomatiques',
                        'Modificateurs d\'intensit√©',
                        'Contexte fran√ßais/anglais',
                        'Utilis√© par radar-party-score.R pour calculer le ton'
                    ]
                }
            },
            sources: {
                'r-media-headlines': {
                    title: 'Source: r-media-headlines',
                    description: 'Glue Job Python ETL qui transforme les donn√©es de scraping en table datawarehouse',
                    details: [
                        'üî¥ Type: Glue Job Python ETL (pas un refiner R)',
                        'üìç Localisation: Code Python externe au repo refiners',
                        '‚è∞ Fr√©quence: 6x/jour (00:03, 04:03, 08:03, 12:03, 16:03, 20:03 UTC)',
                        'üéØ Fonction: Job ETL qui transforme les donn√©es brutes de scraping',
                        '',
                        'üìã Processus ETL (Extract-Transform-Load):',
                        '‚Ä¢ EXTRACT: Lit les donn√©es des scrapers (qui tournent toutes les 10 min)',
                        '‚Ä¢ TRANSFORM: Nettoie HTML, normalise texte, calcule dur√©es de Une',
                        '‚Ä¢ LOAD: √âcrit dans table datawarehouse r-media-headlines',
                        '',
                        'üîÑ Architecture:',
                        '‚Üí Scrapers Python (10 min) capturent headlines en temps r√©el',
                        '‚Üí Glue Job ETL (6x/jour) agr√®ge et transforme ces donn√©es',
                        '‚Üí Table r-media-headlines = donn√©es nettoy√©es et pr√™tes',
                        '',
                        'üí° Pourquoi "Source Externe"?',
                        '‚Üí C\'est un Glue Job Python (pas un refiner R)',
                        '‚Üí Point d\'entr√©e du syst√®me (premi√®re transformation)',
                        '‚Üí Les scrapers en amont sont externes au syst√®me de refiners',
                        '',
                        'üïê Ex√©cution: 6x/jour (00:03, 04:03, 08:03, 12:03, 16:03, 20:03 UTC)',
                        'üìä Sortie: Table r-media-headlines dans datawarehouse'
                    ]
                },
                'r-media-frontpages': {
                    title: 'Glue Job Python: r-media-frontpages',
                    description: 'Job Python AWS Glue qui scrape les frontpages des m√©dias pour SONAR',
                    details: [
                        'Scrape les pages d\'accueil de chaque m√©dia toutes les 4h',
                        'Capture des screenshots et m√©tadonn√©es',
                        'Utilis√© exclusivement par le pipeline SONAR',
                        'Class√© "Source Externe" car c\'est un Glue Job Python (pas un Refiner R)',
                        'Ex√©cution: 6x/jour en parall√®le avec r-media-headlines',
                        'Output: Table Glue brute (non-datamart)'
                    ]
                }
            },
            outputs: {
                'hot20-files': {
                    title: 'Hot 20 - Fichiers PNG et HTML',
                    description: '6 fichiers g√©n√©r√©s chaque vendredi √† 17:00 UTC (12:00 EST)',
                    details: [
                        'üìä 3 fichiers PNG (visualisations):',
                        '‚Ä¢ hot20_qc.png - TOP 20 Qu√©bec',
                        '‚Ä¢ hot20_can.png - TOP 20 Canada',
                        '‚Ä¢ hot20_usa.png - TOP 20 USA',
                        '',
                        'üåê 3 fichiers HTML (tableaux interactifs):',
                        '‚Ä¢ hot20_qc.html - Version interactive QC',
                        '‚Ä¢ hot20_can.html - Version interactive CAN',
                        '‚Ä¢ hot20_usa.html - Version interactive USA',
                        '',
                        'üìç Localisation: Publi√©s sur S3',
                        '‚è∞ G√©n√©ration: Vendredis 17:00 UTC (12:00 EST)',
                        'üé® Format: Tables GT (Grammar of Tables) avec styling professionnel'
                    ]
                },
                'slack-hot20': {
                    title: 'Notifications Slack - Hot 20',
                    description: 'Publication hebdomadaire dans le canal Slack #hot20',
                    details: [
                        'üì¢ Canal: #hot20',
                        '‚è∞ Fr√©quence: Chaque vendredi 17:00 UTC (12:00 EST)',
                        'üìé Contenu envoy√©:',
                        '‚Ä¢ Message r√©capitulatif de la semaine',
                        '‚Ä¢ 3 images PNG attach√©es (QC, CAN, USA)',
                        '‚Ä¢ Liens vers les tableaux HTML interactifs',
                        '',
                        'üéØ Audience: √âquipe interne + analystes politiques',
                        'üí° But: Suivi hebdomadaire des headlines les plus saillants'
                    ]
                },
                'sonar-heatmaps': {
                    title: 'SONAR - Heatmaps de Qualit√©',
                    description: 'Visualisations de la qualit√© du scraping sur 14 jours',
                    details: [
                        'üìä Fichiers g√©n√©r√©s:',
                        '‚Ä¢ sonar_heatmap.png - Image statique',
                        '‚Ä¢ sonar_heatmap.html - Version interactive',
                        '',
                        'üìà Contenu visualis√©:',
                        '‚Ä¢ Qualit√© du scraping par m√©dia (lignes)',
                        '‚Ä¢ √âvolution sur 14 derniers jours (colonnes)',
                        '‚Ä¢ Code couleur: vert (bon) ‚Üí rouge (probl√®me)',
                        '',
                        'üé® M√©triques affich√©es:',
                        '‚Ä¢ Taux de succ√®s du scraping',
                        '‚Ä¢ Compl√©tude des donn√©es',
                        '‚Ä¢ Nombre d\'erreurs',
                        '‚Ä¢ Score qualit√© global',
                        '',
                        '‚è∞ G√©n√©ration: Mercredis 09:00 UTC (04:00 EST)',
                        'üìç Localisation: Publi√©s sur S3'
                    ]
                },
                'slack-sonar': {
                    title: 'Notifications Slack - SONAR',
                    description: 'Alertes hebdomadaires de monitoring qualit√©',
                    details: [
                        'üì¢ Canal: #sonar',
                        '‚è∞ Fr√©quence: Mercredis 09:00 UTC (04:00 EST)',
                        'üìé Contenu envoy√©:',
                        '‚Ä¢ Rapport de qualit√© sur 14 jours',
                        '‚Ä¢ Heatmap PNG attach√©e',
                        '‚Ä¢ Lien vers heatmap HTML interactive',
                        '‚Ä¢ Alertes sur m√©dias probl√©matiques',
                        '',
                        'üö® Alertes automatiques si:',
                        '‚Ä¢ Score qualit√© < seuil d√©fini',
                        '‚Ä¢ Augmentation soudaine des erreurs',
                        '‚Ä¢ M√©dia non-scraped pendant > 24h',
                        '',
                        'üéØ Audience: √âquipe technique DevOps',
                        'üí° But: Monitoring proactif de la sant√© du syst√®me'
                    ]
                },
                'all-final-tables': {
                    title: 'Toutes les Tables Finales',
                    description: 'Collection compl√®te des tables datamart pour publication',
                    details: [
                        'üìã Tables incluses:',
                        '',
                        'üìä Issues Score (3 tables):',
                        '‚Ä¢ issues_score_day - Scores quotidiens par enjeu',
                        '‚Ä¢ issues_score_week - Agr√©gation hebdomadaire',
                        '‚Ä¢ issues_score_month - Agr√©gation mensuelle',
                        '',
                        'üèõÔ∏è Party Scores (6 tables):',
                        '‚Ä¢ federal_parties_score_day/week/month',
                        '‚Ä¢ provincial_parties_score_day/week/month',
                        '',
                        'üí≠ Reflet (3 tables):',
                        '‚Ä¢ reflet_day - Synth√®ses quotidiennes LLM',
                        '‚Ä¢ reflet_week - Synth√®ses hebdomadaires',
                        '‚Ä¢ reflet_month - Synth√®ses mensuelles',
                        '',
                        'üì∞ Headline of Headlines (1 table):',
                        '‚Ä¢ headline_of_headlines - Une des Unes par p√©riode 4h',
                        '',
                        'üéØ Total: 13 tables ‚Üí 13 fichiers JSON publi√©s'
                    ]
                },
                'json-files': {
                    title: '13 Fichiers JSON Publi√©s',
                    description: 'Donn√©es transform√©es en JSON pour le frontend',
                    details: [
                        'üìÅ Structure S3:',
                        's3://bucket/data/refined/',
                        '',
                        'üìÇ day/ (4 fichiers):',
                        '‚Ä¢ issues_score_day.json',
                        '‚Ä¢ federal_parties_score_day.json',
                        '‚Ä¢ provincial_parties_score_day.json',
                        '‚Ä¢ reflet_day.json',
                        '',
                        'üìÇ week/ (4 fichiers):',
                        '‚Ä¢ issues_score_week.json',
                        '‚Ä¢ federal_parties_score_week.json',
                        '‚Ä¢ provincial_parties_score_week.json',
                        '‚Ä¢ reflet_week.json',
                        '',
                        'üìÇ month/ (5 fichiers):',
                        '‚Ä¢ issues_score_month.json',
                        '‚Ä¢ federal_parties_score_month.json',
                        '‚Ä¢ provincial_parties_score_month.json',
                        '‚Ä¢ reflet_month.json',
                        '‚Ä¢ headline_of_headlines.json',
                        '',
                        'üîÑ Mise √† jour: 5x/jour (+36min apr√®s Glue)',
                        'üåê Consomm√©s par: Frontend React du site vitrine'
                    ]
                },
                'frontend-vitrine': {
                    title: 'Frontend Vitrine D√©mocratique',
                    description: 'Site web public affichant toutes les analyses politiques',
                    details: [
                        'üåê Site web: Vitrine D√©mocratique',
                        'üîó URL DEV: <a href="https://dev.vitrinedemocratique.com/beta.html" target="_blank" style="color: #4A90E2; font-weight: bold;">https://dev.vitrinedemocratique.com/beta.html</a>',
                        '',
                        'üìä Pages disponibles:',
                        '‚Ä¢ Dashboard principal avec KPIs',
                        '‚Ä¢ Vue par enjeux (12 cat√©gories)',
                        '‚Ä¢ Vue par partis (f√©d√©ral + provincial)',
                        '‚Ä¢ Synth√®ses Reflet (quotidiennes/hebdo/mensuelles)',
                        '‚Ä¢ Une des Unes (headline of headlines)',
                        '',
                        'üîÑ Donn√©es:',
                        '‚Ä¢ Lectures depuis S3 (13 fichiers JSON)',
                        '‚Ä¢ Mise √† jour: 5x/jour via vitrine-graph-data.R',
                        '‚Ä¢ Latence: ~40 minutes apr√®s scraping',
                        '',
                        'üé® Technologie:',
                        '‚Ä¢ Frontend: React + TypeScript',
                        '‚Ä¢ Graphiques: Recharts / D3.js',
                        '‚Ä¢ Hosting: CloudFront + S3',
                        '',
                        'üéØ Audience: Grand public + analystes politiques'
                    ]
                }
            }
        };

        // Filter controls
        const buttons = document.querySelectorAll('.btn');
        const pipelines = document.querySelectorAll('.pipeline');

        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                const filter = btn.dataset.filter;
                buttons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                pipelines.forEach(pipeline => {
                    if (filter === 'all' || pipeline.dataset.pipeline === filter) {
                        pipeline.classList.remove('hidden');
                    } else {
                        pipeline.classList.add('hidden');
                    }
                });
            });
        });

        // Node type filter controls - met en √©vidence le type s√©lectionn√©
        const nodeButtons = document.querySelectorAll('.btn-node');
        let selectedNodeType = null;

        nodeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const nodeType = btn.dataset.nodeFilter;

                // Si on clique sur le m√™me bouton, on d√©s√©lectionne (reset)
                if (selectedNodeType === nodeType) {
                    selectedNodeType = null;
                    nodeButtons.forEach(b => b.classList.add('active-node'));
                    // Remettre tous les nodes √† opacit√© normale
                    document.querySelectorAll('.node').forEach(node => {
                        node.style.opacity = '1';
                    });
                } else {
                    // S√©lectionner le nouveau type
                    selectedNodeType = nodeType;
                    // Mettre √† jour les boutons
                    nodeButtons.forEach(b => {
                        if (b.dataset.nodeFilter === nodeType) {
                            b.classList.add('active-node');
                        } else {
                            b.classList.remove('active-node');
                        }
                    });

                    // Mettre en √©vidence seulement le type s√©lectionn√©
                    document.querySelectorAll('.node').forEach(node => {
                        const nodeClass = node.className.split(' ').find(c => c.startsWith('node-'));
                        if (nodeClass) {
                            const type = nodeClass.replace('node-', '');
                            if (type === nodeType) {
                                node.style.opacity = '1';
                            } else {
                                node.style.opacity = '0.2';
                            }
                        }
                    });
                }
            });
        });

        // Collapsible pipelines
        const headers = document.querySelectorAll('.pipeline-header');
        headers.forEach(header => {
            header.addEventListener('click', () => {
                header.parentElement.classList.toggle('collapsed');
            });
        });

        // Modal functionality
        const modal = document.getElementById('modal');
        const modalBody = document.getElementById('modal-body');
        const closeBtn = document.querySelector('.close-modal');

        function showModal(type, key) {
            const data = modalData[type][key];
            if (!data) return;

            let html = `<h2>${data.title}</h2>`;
            html += `<p><strong>${data.description}</strong></p>`;

            if (data.columns) {
                html += '<h3>üìã Colonnes de la table:</h3><ul>';
                data.columns.forEach(col => {
                    html += `<li>${col}</li>`;
                });
                html += '</ul>';
            }

            if (data.details) {
                html += '<h3>‚ÑπÔ∏è D√©tails:</h3><ul>';
                data.details.forEach(detail => {
                    html += `<li>${detail}</li>`;
                });
                html += '</ul>';
            }

            modalBody.innerHTML = html;
            modal.classList.add('show');
        }

        closeBtn.addEventListener('click', () => {
            modal.classList.remove('show');
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('show');
            }
        });

        // Add click handlers to nodes
        document.querySelectorAll('[data-table]').forEach(node => {
            node.addEventListener('click', () => {
                showModal('tables', node.dataset.table);
            });
        });

        document.querySelectorAll('[data-refiner]').forEach(node => {
            node.addEventListener('click', () => {
                showModal('refiners', node.dataset.refiner);
            });
        });

        document.querySelectorAll('[data-dict]').forEach(node => {
            node.addEventListener('click', () => {
                showModal('dicts', node.dataset.dict);
            });
        });

        document.querySelectorAll('[data-source]').forEach(node => {
            node.addEventListener('click', () => {
                showModal('sources', node.dataset.source);
            });
        });

        document.querySelectorAll('[data-output]').forEach(node => {
            node.addEventListener('click', () => {
                showModal('outputs', node.dataset.output);
            });
        });
    </script>
</body>
</html>
