<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitrine d√©mocratique - Workflow 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: 2px solid #333;
            background: white;
            color: #333;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn:hover {
            background: #555;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .btn.active {
            background: #333;
            color: white;
        }

        /* Boutons de filtre par type de node */
        .btn-node {
            padding: 8px 16px;
            border: 2px solid #333;
            background: white;
            color: #333;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .node-color-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: inline-block;
            border: 2px solid rgba(0, 0, 0, 0.2);
        }

        .btn-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn-node.active-node {
            opacity: 1;
        }

        .btn-node:not(.active-node) {
            opacity: 0.4;
        }

        .pipeline {
            margin-bottom: 30px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .pipeline.hidden {
            display: none;
        }

        .pipeline-header {
            padding: 20px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .pipeline-header:hover {
            filter: brightness(1.1);
        }

        .pipeline-content {
            background: white;
            padding: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            overflow-x: auto;
            min-height: 150px;
        }

        .pipeline-content::-webkit-scrollbar {
            height: 8px;
        }

        .pipeline-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .pipeline-content::-webkit-scrollbar-thumb {
            background: #999;
            border-radius: 4px;
        }

        .node {
            min-width: 160px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .node:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        }

        .node-refiner {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            border: 3px solid #2E5C8A;
        }

        .node-table {
            background: linear-gradient(135deg, #50C878 0%, #3BA05F 100%);
            color: white;
            border: 3px solid #2D7A4A;
        }

        .node-output {
            background: linear-gradient(135deg, #FFB347 0%, #FF8C00 100%);
            color: white;
            border: 3px solid #CC7000;
        }

        .node-dict {
            background: linear-gradient(135deg, #9B59B6 0%, #7D3C98 100%);
            color: white;
            border: 3px solid #5E2A6F;
        }

        .node-source {
            background: linear-gradient(135deg, #E74C3C 0%, #C0392B 100%);
            color: white;
            border: 3px solid #922B21;
        }

        .arrow {
            font-size: 24px;
            color: #666;
            font-weight: bold;
            flex-shrink: 0;
        }

        .node-schedule {
            font-size: 10px;
            margin-top: 8px;
            opacity: 0.9;
            font-weight: normal;
        }

        .node-detail {
            font-size: 10px;
            margin-top: 5px;
            opacity: 0.85;
            font-weight: normal;
            line-height: 1.4;
        }

        /* Pipeline-specific colors - tous en gris */
        .pipeline-salient .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-issues .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-parties .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-reflet .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-headline .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-hot20 .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-sonar .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }
        .pipeline-vitrine .pipeline-header { background: linear-gradient(135deg, #555 0%, #333 100%); }

        .toggle-icon {
            transition: transform 0.3s;
        }

        /* Badges DEV/PROD */
        .badge-prod {
            display: inline-block;
            background: linear-gradient(135deg, #d9534f 0%, #c9302c 100%);
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 11px;
            margin: 0 4px;
            border: 1px solid #ac2925;
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .badge-dev {
            display: inline-block;
            background: linear-gradient(135deg, #5cb85c 0%, #449d44 100%);
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 11px;
            margin: 0 4px;
            border: 1px solid #398439;
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .env-source {
            font-weight: 600;
            margin-right: 2px;
        }

        .env-output {
            font-weight: 600;
            margin-right: 2px;
        }

        /* Node environment badges - PROD source (rouge) */
        .node[data-env-source="PROD"]::before {
            content: "PROD";
            position: absolute;
            top: -8px;
            left: -8px;
            background: linear-gradient(135deg, #d9534f 0%, #c9302c 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 9px;
            border: 1px solid #ac2925;
            pointer-events: none;
            z-index: 5;
            user-select: none;
        }

        /* Node environment badges - DEV source (vert) */
        .node[data-env-source="DEV"]::before {
            content: "DEV";
            position: absolute;
            top: -8px;
            left: -8px;
            background: linear-gradient(135deg, #5cb85c 0%, #449d44 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 9px;
            border: 1px solid #398439;
            pointer-events: none;
            z-index: 5;
            user-select: none;
        }

        /* Node environment badges - DEV output (vert) */
        .node[data-env-output="DEV"]::after {
            content: "DEV";
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #5cb85c 0%, #449d44 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 9px;
            border: 1px solid #398439;
            pointer-events: none;
            z-index: 5;
            user-select: none;
        }

        .pipeline.collapsed .pipeline-content {
            display: none !important;
        }

        .pipeline.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .frequency {
            font-size: 11px;
            opacity: 0.9;
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 12px;
            border-radius: 20px;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s;
        }

        .modal-content h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 3px solid #555;
            padding-bottom: 10px;
        }

        .modal-content h3 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .modal-content ul {
            list-style: none;
            padding: 0;
        }

        .modal-content li {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f9fa;
            border-left: 4px solid #555;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .modal-content p {
            line-height: 1.6;
            color: #555;
            margin-bottom: 15px;
        }

        .close-modal {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: #333;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .info-badge {
            display: block;
            background: rgba(255, 255, 255, 0.3);
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-top: 8px;
            cursor: help;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Les pipelines de la Vitrine d√©mocratique</h1>
        <p class="subtitle">Architecture compl√®te ‚Ä¢ Derni√®re mise √† jour le 19 janvier 2026 ‚Ä¢ <a href="https://dev.vitrinedemocratique.com/beta.html" target="_blank" style="color: #4A90E2; text-decoration: none; font-weight: bold;">üåê Voir le site vitrine (DEV)</a></p>

        <div class="controls">
            <button class="btn active" data-filter="all">Voir tous les pipelines</button>
            <button class="btn" data-filter="salient">Salient Index</button>
            <button class="btn" data-filter="issues">Issues Score</button>
            <button class="btn" data-filter="parties">Party Scores</button>
            <button class="btn" data-filter="reflet">Reflet</button>
            <button class="btn" data-filter="headline">Headline of Headlines</button>
            <button class="btn" data-filter="hot20">Hot 20</button>
            <button class="btn" data-filter="sonar">SONAR</button>
            <button class="btn" data-filter="vitrine">Publication</button>
        </div>

        <!-- Filtres par type de node -->
        <div class="controls" style="margin-top: 10px; margin-bottom: 20px;">
            <button class="btn-node btn-node-source active-node" data-node-filter="source">
                <span class="node-color-box" style="background: linear-gradient(135deg, #E74C3C 0%, #C0392B 100%);"></span>
                Chargeur ETL
            </button>
            <button class="btn-node btn-node-table active-node" data-node-filter="table">
                <span class="node-color-box" style="background: linear-gradient(135deg, #50C878 0%, #3BA05F 100%);"></span>
                Table Datamart
            </button>
            <button class="btn-node btn-node-dict active-node" data-node-filter="dict">
                <span class="node-color-box" style="background: linear-gradient(135deg, #9B59B6 0%, #7D3C98 100%);"></span>
                Dictionnaire
            </button>
            <button class="btn-node btn-node-refiner active-node" data-node-filter="refiner">
                <span class="node-color-box" style="background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);"></span>
                Refiner (R)
            </button>
            <button class="btn-node btn-node-output active-node" data-node-filter="output">
                <span class="node-color-box" style="background: linear-gradient(135deg, #FFB347 0%, #FF8C00 100%);"></span>
                Output (JSON/Slack)
            </button>
        </div>

        <!-- Horaire Glue Jobs ETL -->
        <p class="subtitle" style="margin-top: -10px; margin-bottom: 20px; font-size: 13px; color: #E74C3C; font-weight: 600;">
            ‚è∞ Glue Jobs ETL (r-media-headlines, r-media-frontpages): 6x/jour ‚Üí 00:03, 04:03, 08:03, 12:03, 16:03, 20:03 UTC<br>
            <span style="font-size: 12px; color: #999;">(19:03, 23:03, 03:03, 07:03, 11:03, 15:03 EST)</span>
        </p>

        <!-- SALIENT INDEX (BASE PIPELINE) -->
        <div class="pipeline pipeline-salient" data-pipeline="salient">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üîµ Salient Index (Pipeline de Base)</span>
                <span class="frequency">6x/jour: 00:20, 04:20, 08:20, 12:20, 16:20, 20:20 UTC<br>(19:20, 23:20, 03:20, 07:20, 11:20, 15:20 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-headlines" data-env-source="PROD">
                    r-media-headlines
                    <div class="node-detail">Glue Job Python</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="salient-objects">
                    radar-salient-objects.R
                    <div class="node-schedule">‚è∞ +17min apr√®s Glue</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="salient_headlines_objects" data-env-output="DEV">
                    salient_headlines_objects
                    <div class="node-detail">Table des objets saillants</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="salient-index">
                    radar-salient-index.R
                    <div class="node-detail">Calcul indices</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="salient_index" data-env-output="DEV">
                    salient_index
                    <div class="node-detail">Indices de saillance</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- ISSUES SCORE -->
        <div class="pipeline pipeline-issues" data-pipeline="issues">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üìä Issues Score (Scores par Enjeu)</span>
                <span class="frequency">Daily: 12:09, 16:09, 20:09 UTC ‚Ä¢ Weekly: 20:11 UTC ‚Ä¢ Monthly: 20:14 UTC<br>(Daily: 07:09, 11:09, 15:09 EST ‚Ä¢ Weekly: 15:11 EST ‚Ä¢ Monthly: 15:14 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-headlines" data-env-source="PROD">
                    r-media-headlines
                    <div class="node-detail">Glue Job Python ETL</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="issues">
                    dict-issues-two-categories
                    <div class="node-detail">12 cat√©gories</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="headlines-issues">
                    radar-headlines-issues.R
                    <div class="node-detail">Classifie headlines</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="headlines_issues" data-env-output="DEV">
                    headlines_issues_*
                    <div class="node-detail">day/week/month</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="issues-score">
                    radar-issues-score.R
                    <div class="node-schedule">‚è∞ 12:09, 16:09, 20:09 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="issues_score" data-env-output="DEV">
                    issues_score_day<br>issues_score_week<br>issues_score_month
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- PARTY SCORES -->
        <div class="pipeline pipeline-parties" data-pipeline="parties">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üèõÔ∏è Party Scores (Mentions Partis Politiques)</span>
                <span class="frequency">Daily: 12:18, 16:18, 20:18 UTC ‚Ä¢ Weekly: 20:20 UTC ‚Ä¢ Monthly: 20:22 UTC<br>(Daily: 07:18, 11:18, 15:18 EST ‚Ä¢ Weekly: 15:20 EST ‚Ä¢ Monthly: 15:22 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="salient_index" data-env-source="DEV">
                    salient_index
                    <div class="node-detail">Index de saillance par objet</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="parties-ca">
                    dict-political-parties-ca
                    <div class="node-detail">Partis f√©d√©raux</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="parties-qc">
                    dict-political-parties-qc
                    <div class="node-detail">Partis provinciaux</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-dict" data-type="dict" data-dict="sentiments">
                    dict-sentiments
                    <div class="node-detail">Analyse de ton</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="party-score">
                    radar-party-score.R
                    <div class="node-schedule">‚è∞ 12:18, 16:18, 20:18 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="parties_score" data-env-output="DEV">
                    federal_parties_score_*<br>provincial_parties_score_*
                    <div class="node-detail">day/week/month</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- REFLET -->
        <div class="pipeline pipeline-reflet" data-pipeline="reflet">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üí≠ Reflet (Synth√®ses LLM par Enjeu)</span>
                <span class="frequency">Daily: 12:25, 16:25, 20:25 UTC ‚Ä¢ Weekly: 20:28 UTC ‚Ä¢ Monthly: 20:30 UTC<br>(Daily: 07:25, 11:25, 15:25 EST ‚Ä¢ Weekly: 15:28 EST ‚Ä¢ Monthly: 15:30 EST)</span>
            </div>
            <div class="pipeline-content" style="display: grid; grid-template-columns: auto auto auto auto auto auto auto auto auto auto auto auto auto; gap: 15px; align-items: center;">
                <!-- Ligne 1: Daily/Weekly -->
                <div class="node node-table" data-type="table" data-table="headlines_issues_day" data-env-source="DEV">
                    headlines_issues_day
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-table" data-type="table" data-table="headlines_issues_week" data-env-source="DEV">
                    headlines_issues_week
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="reflet-daily-weekly">
                    radar-reflet-daily-weekly.R
                    <div class="node-schedule">‚è∞ 12:25, 16:25, 20:25 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div style="position: relative;">
                    <div class="node node-table" data-type="table" data-table="reflet_day" data-env-output="DEV">
                        reflet_day
                        <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                    </div>
                    <!-- Fl√®che verticale depuis ce node -->
                    <div style="position: absolute; top: 100%; left: 50%; transform: translateX(-50%); height: 30px; display: flex; align-items: center;">
                        <div style="font-size: 24px; color: #666; transform: rotate(90deg);">‚Üí</div>
                    </div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-table" data-type="table" data-table="reflet_week" data-env-output="DEV">
                    reflet_week
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>

                <!-- Ligne 2: Monthly - utilise grid-column pour alignement exact -->
                <div class="node node-refiner" data-type="refiner" data-refiner="reflet-monthly" style="grid-column: 7; margin-top: 40px;">
                    radar-reflet-monthly.R
                    <div class="node-schedule">‚è∞ 20:30 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow" style="grid-column: 8; margin-top: 40px;">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="reflet_month" data-env-output="DEV" style="grid-column: 9; margin-top: 40px;">
                    reflet_month
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- HEADLINE OF HEADLINES -->
        <div class="pipeline pipeline-headline" data-pipeline="headline">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üì∞ Headline of Headlines (Une des Unes)</span>
                <span class="frequency">6x/jour: 00:28, 04:28, 08:28, 12:28, 16:28, 20:28 UTC<br>(19:28, 23:28, 03:28, 07:28, 11:28, 15:28 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="salient_headlines_objects" data-env-source="DEV">
                    salient_headlines_objects
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="headline-of-headlines">
                    radar-headline-of-headlines.R
                    <div class="node-detail">Synth√®se LLM</div>
                    <div class="node-schedule">‚è∞ 00:28, 04:28, 08:28, 12:28, 16:28, 20:28 UTC</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="headline_of_headlines" data-env-output="DEV">
                    headline_of_headlines
                    <div class="node-detail">Une par p√©riode 4h</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
            </div>
        </div>

        <!-- HOT 20 -->
        <div class="pipeline pipeline-hot20" data-pipeline="hot20">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üî• RADAR+ Hot 20 (TOP 20 Hebdomadaire)</span>
                <span class="frequency">Vendredis: 16:30 UTC<br>(11:30 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="salient_headlines_objects" data-env-source="DEV">
                    salient_headlines_objects
                    <div class="node-detail">Semaine compl√®te</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="hot20">
                    radar-hot-20.R
                    <div class="node-schedule">‚è∞ Ven 16:30</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="hot_20_headlines" data-env-output="DEV">
                    hot_20_headlines
                    <div class="node-detail">3 pays</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="hot20-files">
                    6 PNG + 6 HTML
                    <div class="node-detail">QC, CAN, USA √ó 2</div>
                    <div class="info-badge">üñºÔ∏è Cliquer pour voir exemples</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="slack-hot20">
                    Slack: hot20
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
            </div>
        </div>

        <!-- SONAR -->
        <div class="pipeline pipeline-sonar" data-pipeline="sonar">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üì° SONAR Heatmaps (Monitoring Qualit√©)</span>
                <span class="frequency">Mercredis: 12:30 UTC<br>(07:30 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-source" data-type="source" data-source="r-media-frontpages" data-env-source="PROD">
                    r-media-frontpages
                    <div class="node-detail">Glue Job Python</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">+</div>
                <div class="node node-source" data-type="source" data-source="r-media-headlines" data-env-source="PROD">
                    r-media-headlines
                    <div class="node-detail">Glue Job Python</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="sonar">
                    sonar.R
                    <div class="node-detail">Extrait donn√©es SONAR</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-table" data-type="table" data-table="data_quality_14_days" data-env-output="DEV">
                    data_quality_14_days
                    <div class="node-detail">Datamart: sonar</div>
                    <div class="info-badge">üìã Cliquer pour voir colonnes</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="sonar-heatmaps">
                    sonar-heatmaps.R
                    <div class="node-schedule">‚è∞ Mer 09:00</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="sonar-heatmaps">
                    6 PNG Heatmaps
                    <div class="node-detail">fp, uh, body, title, author, words</div>
                    <div class="info-badge">üñºÔ∏è Cliquer pour voir exemples</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="slack-sonar">
                    Slack: sonar
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
            </div>
        </div>

        <!-- PUBLICATION VITRINE -->
        <div class="pipeline pipeline-vitrine" data-pipeline="vitrine">
            <div class="pipeline-header">
                <span class="toggle-icon">‚ñº</span>
                <span>üì§ Publication Vitrine (JSON vers S3 Frontend)</span>
                <span class="frequency">5x/jour: 04:39, 08:39, 12:39, 16:39, 20:39 UTC<br>(23:39, 03:39, 07:39, 11:39, 15:39 EST)</span>
            </div>
            <div class="pipeline-content">
                <div class="node node-table" data-type="table" data-table="all-final-tables" data-env-source="DEV">
                    Toutes les tables finales
                    <div class="node-detail">issues_score_*, parties_score_*, reflet_*, headline_of_headlines</div>
                    <div class="info-badge">üìã Cliquer pour liste compl√®te</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-refiner" data-type="refiner" data-refiner="vitrine-graph-data">
                    vitrine-graph-data.R
                    <div class="node-schedule">‚è∞ 5x/jour +36min</div>
                    <div class="info-badge">‚ÑπÔ∏è Cliquer pour d√©tails</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" data-type="output" data-output="json-files">
                    13 fichiers JSON
                    <div class="node-detail">Publi√©s sur S3</div>
                    <div class="info-badge">üìÑ Cliquer pour liste des fichiers</div>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="node node-output" style="min-width: 200px;" data-type="output" data-output="frontend-vitrine">
                    Frontend Vitrine
                    <div class="node-detail">Site web public vitrine d√©mocratique</div>
                    <div class="info-badge">üåê Cliquer pour ouvrir site</div>
                </div>
            </div>
        </div>

    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        console.log('üîß Script charg√©');
        
        document.addEventListener('DOMContentLoaded', function() {
        console.log('‚úÖ DOM pr√™t - Initialisation...');
        
        // Modal data
        const modalData = {
            tables: {
                'salient_headlines_objects': {
                    title: 'Table: salient_headlines_objects',
                    description: 'Table principale contenant les headlines et leurs objets saillants extraits par GPT-4o',
                    columns: [
                        'üìç IDENTIFIANTS:',
                        'media_id - Identifiant du m√©dia (JDM, LAP, LED, CBC, CTV, etc. - EXCLUT TVA)',
                        'country_id - Pays (QC/CAN/USA)',
                        'language - Langue du headline (fr/en/autre)',
                        '',
                        '‚è∞ TEMPORALIT√â:',
                        'headline_start_montreal_tz - D√©but du headline en Une (heure Montr√©al, format: YYYY-MM-DD HH:MM:SS.mmm)',
                        'headline_stop_montreal_tz - Fin du headline en Une (heure Montr√©al)',
                        'headline_start_utc - D√©but du headline (UTC, format: YYYY-MM-DD HH:MM:SS.mmm)',
                        'headline_stop_utc - Fin du headline (UTC)',
                        'headline_minutes - Dur√©e du headline en Une (minutes, INTEGER, min=10)',
                        'headline_prop - Proportion de la p√©riode couverte (DOUBLE, 0.00-1.00)',
                        'time_interval_montreal_tz - Intervalle 4h Montr√©al (00-04, 04-08, 08-12, 12-16, 16-20, 20-24)',
                        'time_interval_utc - Intervalle 4h UTC (00-04, 04-08, 08-12, 12-16, 16-20, 20-24)',
                        '',
                        'üì∞ CONTENU (nettoy√©):',
                        'title - Titre du headline (noms m√©dias supprim√©s, espaces nettoy√©s)',
                        'body - Corps du texte (noms m√©dias supprim√©s)',
                        'author - Auteur de l\'article',
                        'url - URL de l\'article',
                        '',
                        'üéØ EXTRACTION LLM:',
                        'extracted_objects - Objets saillants extraits (CSV, en ANGLAIS, lowercase, sans ponctuation)',
                        'prompt - Prompt utilis√© pour extraction GPT-4o (TEXT)',
                        'conversation - Conversation compl√®te user+system (JSON)',
                        'response - R√©ponse GPT-4o brute (JSON avec content, model, usage, etc.)',
                        '',
                        'üè∑Ô∏è METADATA:',
                        'tag - Timestamp de publication (format: YYYY-MM-DD HH:MM)'
                    ],
                    details: [
                        'üîÑ Processus incr√©mental: Charge uniquement les nouveaux headlines depuis le dernier trait√©',
                        'üìä Granularit√©: Blocs de 4 heures',
                        'üåç Pays couverts: QC (Qu√©bec), CAN (Canada), USA (√âtats-Unis)',
                        'üö´ Exclusions: TVA (duplique JDM)',
                        'üî§ Langues: fr (fran√ßais), en (anglais)'
                    ]
                },
                'salient_index': {
                    title: 'Table: salient_index',
                    description: 'Indices de saillance absolus calcul√©s par radar-salient-index.R (SANS LLM - calculs purs)',
                    columns: [
                        'üåç DIMENSIONS:',
                        'country_id - Pays (QC/CAN/USA)',
                        'date_utc - Date (UTC)',
                        'time_interval_utc - Intervalle 4h UTC (00-04, 04-08, 08-12, 12-16, 16-20, 20-24)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'time_interval_montreal_tz - Intervalle 4h Montr√©al',
                        'extracted_objects - Nom objet saillant (normalis√© lowercase, sans ponctuation, ANGLAIS)',
                        '',
                        'üìä M√âTRIQUES DE BASE:',
                        'n - Nombre d\'occurrences de l\'objet (INTEGER)',
                        'total_minutes_objet - Somme du temps en Une (minutes, DOUBLE)',
                        '',
                        '‚öñÔ∏è POND√âRATIONS:',
                        'total_pond_time - Somme pond√©r√©e intra-m√©dia (headline_minutes / mean_time_m√©dia)',
                        'total_pond_time_norm - Somme pond√©r√©e inter-m√©dias (headline_minutes / mean_time_global)',
                        '',
                        'üéØ INDICE FINAL:',
                        'absolute_normalized_index - Indice saillance absolu (FORMULE: n √ó total_pond_time_norm)',
                        '',
                        'üì∞ SOURCES (JSON Arrays):',
                        'n_titles - Nombre de titres uniques (INTEGER)',
                        'n_bodies - Nombre de textes uniques (INTEGER)',
                        'urls - Liste URLs (JSON array de strings)',
                        'titles - Liste titres (JSON array de strings)',
                        'bodies - Liste textes complets (JSON array de strings)'
                    ],
                    details: [
                        'üìà FORMULE CL√âS:',
                        '‚Ä¢ pond_time = headline_minutes / mean_time_m√©dia',
                        '‚Ä¢ pond_time_norm = headline_minutes / mean_time_global (moyenne de tous les m√©dias)',
                        '‚Ä¢ absolute_normalized_index = n √ó Œ£(pond_time_norm)',
                        '',
                        'üîÑ Processus incr√©mental: Traite un bloc 4h √† la fois',
                        'üåç Granularit√©: Par pays √ó date √ó intervalle 4h √ó objet',
                        'üìä Tri: Par absolute_normalized_index DESC (les plus saillants en premier)',
                        'üö´ Pas de tag column (contrairement √† salient_headlines_objects)'
                    ]
                },
                'headlines_issues_day': {
                    title: 'Table: headlines_issues_day',
                    description: 'Headlines classifi√©s par enjeux - format quotidien (valid√© depuis radar-headlines-issues.R)',
                    columns: [
                        'date_utc - Date (UTC)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'issue - Enjeu identifi√© (snake_case, ex: economy_and_labour)',
                        'body - Phrase/texte du headline classifi√© sous cet enjeu',
                        'pass - P√©riode (am/pm) - uniquement pour _day'
                    ]
                },
                'headlines_issues_week': {
                    title: 'Table: headlines_issues_week',
                    description: 'Headlines classifi√©s par enjeux - format hebdomadaire (valid√© depuis radar-headlines-issues.R)',
                    columns: [
                        'date_utc - Date (UTC)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'issue - Enjeu identifi√© (snake_case, ex: economy_and_labour)',
                        'body - Phrase/texte du headline classifi√© sous cet enjeu'
                    ]
                },
                'headlines_issues_month': {
                    title: 'Table: headlines_issues_month',
                    description: 'Headlines classifi√©s par enjeux - format mensuel (valid√© depuis radar-headlines-issues.R)',
                    columns: [
                        'date_utc - Date (UTC)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'issue - Enjeu identifi√© (snake_case, ex: economy_and_labour)',
                        'body - Phrase/texte du headline classifi√© sous cet enjeu'
                    ]
                },
                'issues_score': {
                    title: 'Tables: issues_score_*',
                    description: 'Proportions agr√©g√©es par enjeu - somme √† 1.0 (valid√© depuis radar-issues-score.R)',
                    columns: [
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'date_utc - Date (UTC)',
                        'economy_and_labour - Proportion enjeu √©conomie (0-1)',
                        'rights_liberties_minorities_discrimination - Proportion droits/libert√©s (0-1)',
                        'health_and_social_services - Proportion sant√© (0-1)',
                        'public_lands_and_agriculture - Proportion territoires/agriculture (0-1)',
                        'immigration - Proportion immigration (0-1)',
                        'education - Proportion √©ducation (0-1)',
                        'environment_and_energy - Proportion environnement/√©nergie (0-1)',
                        'law_and_crime - Proportion loi/crime (0-1)',
                        'international_affairs_and_defense - Proportion affaires internationales (0-1)',
                        'technology - Proportion technologie (0-1)',
                        'governments_and_governance - Proportion gouvernance (0-1)',
                        'culture_and_nationalism - Proportion culture/nationalisme (0-1)',
                        'pass - P√©riode (am/pm) - uniquement pour _day, absent pour week/month'
                    ]
                },
                'parties_score': {
                    title: 'Tables: *_parties_score_*',
                    description: 'Mentions et ton pond√©r√©s par parti politique (valid√© depuis radar-party-score.R)',
                    columns: [
                        'party - Nom parti (lpc/cpc/ndp/bq/gpc/ppc pour f√©d√©ral | caq/pq/plq/qs/pcq pour provincial)',
                        'weighted_mentions - Mentions pond√©r√©es (nombre d√©cimal)',
                        'weighted_tone - Ton pond√©r√© positif/n√©gatif (nombre d√©cimal)',
                        'date_utc - Date la plus r√©cente de la p√©riode',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'pass - P√©riode (am/pm) - uniquement pour _day, absent pour week/month'
                    ]
                },
                'reflet_day': {
                    title: 'Table: reflet_day',
                    description: 'Synth√®ses quotidiennes LLM par enjeu (valid√© depuis radar-reflet-daily-weekly.R)',
                    columns: [
                        'issue - Enjeu trait√© (snake_case, ex: economy_and_labour)',
                        'summary - R√©sum√© g√©n√©r√© par LLM (texte, liste de points cl√©s)',
                        'date_utc - Date (UTC)',
                        'pass - P√©riode (am/pm)'
                    ]
                },
                'reflet_week': {
                    title: 'Table: reflet_week',
                    description: 'Synth√®ses hebdomadaires LLM (valid√© depuis radar-reflet-daily-weekly.R)',
                    columns: [
                        'issue - Enjeu trait√©',
                        'summary - R√©sum√© hebdomadaire LLM',
                        'date_utc - Date de fin de semaine'
                    ]
                },
                'reflet_month': {
                    title: 'Table: reflet_month',
                    description: 'Synth√®ses mensuelles LLM (valid√© depuis radar-reflet-monthly.R)',
                    columns: [
                        'issue - Enjeu trait√©',
                        'summary - R√©sum√© mensuel LLM',
                        'date_utc - Date de fin de mois'
                    ]
                },
                'headline_of_headlines': {
                    title: 'Table: headline_of_headlines',
                    description: 'Une des Unes par p√©riode 4h - synth√®se LLM (valid√© depuis radar-headline-of-headlines.R)',
                    columns: [
                        'country_id - Pays (CAN, USA)',
                        'date_utc - Date (UTC)',
                        'time_interval_utc - Intervalle 4h UTC (00-04, 04-08, 08-12, 12-16, 16-20, 20-24)',
                        'date_montreal_tz - Date (heure Montr√©al)',
                        'time_interval_montreal_tz - Intervalle 4h Montr√©al',
                        'main_issue - Enjeu principal (snake_case, ex: economy_and_labour)',
                        'main_issue_text_fr - Texte enjeu fran√ßais (ex: "√âconomie et travail")',
                        'main_issue_text_en - Texte enjeu anglais (ex: "Economy and labour")',
                        'title - Titre g√©n√©r√© par LLM (nettoy√© des * et # cons√©cutifs)',
                        'text - Texte du headline g√©n√©r√© par LLM',
                        'objects - Objets saillants principaux (JSON string)',
                        'conversation - Conversation LLM compl√®te (JSON)',
                        'response - R√©ponse LLM brute (JSON)',
                        'prompt - Prompt utilis√© pour g√©n√©ration LLM'
                    ]
                },
                'hot_20_headlines': {
                    title: 'Table: hot_20_headlines',
                    description: 'TOP 20 des headlines hebdomadaires pour QC, CAN, USA',
                    columns: [
                        'country_id - Pays (QC, CAN, USA)',
                        'week_end_date - Date de fin de semaine',
                        'rank - Rang (1-20)',
                        'title - Titre du headline',
                        'url - URL',
                        'media_id - M√©dia source',
                        'salience_score - Score de saillance',
                        'mention_count - Nombre de mentions'
                    ]
                },
                'data_quality_14_days': {
                    title: 'Table: data_quality_14_days',
                    description: 'Donn√©es de qualit√© SONAR sur 14 jours (datamart: sonar)',
                    columns: [
                        'date - Date',
                        'media_id - Identifiant m√©dia',
                        'country_id - Pays',
                        'scraping_success - Taux de succ√®s scraping',
                        'data_completeness - Compl√©tude des donn√©es',
                        'error_count - Nombre d\'erreurs',
                        'quality_score - Score qualit√© global'
                    ]
                }
            },
            refiners: {
                'salient-objects': {
                    title: 'Refiner: radar-salient-objects.R',
                    description: 'Extrait les objets saillants (personnes, organisations, lieux, √©v√©nements) des headlines en utilisant GPT-4o.',
                    details: [
                        'üì• SOURCE: <span class="badge-prod">PROD</span>/datawarehouse - Table r-media-headlines',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Table salient_headlines_objects',
                        '',
                        'ü§ñ MOD√àLE IA: GPT-4o (OpenAI) via ellipsellm',
                        'üìù SYSTEM MESSAGE: "Tu es un journaliste expert en extraction d\'objets saillants..."',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Calcule les dur√©es de Une pour chaque headline (headline_minutes)',
                        '‚Ä¢ Nettoie les titres/textes (supprime noms m√©dias, espaces superflus)',
                        '‚Ä¢ Exclut TVA (duplique Journal de Montr√©al)',
                        '‚Ä¢ D√©tecte langue (fr/en) et pays (QC/CAN/USA)',
                        '‚Ä¢ Cr√©e intervalles 4h (Montr√©al: 00-04, 04-08... et UTC)',
                        '',
                        'üéØ EXTRACTION LLM (objets en ANGLAIS uniquement):',
                        '‚Ä¢ Uniformise formulations ("donald trump" toujours identique)',
                        '‚Ä¢ Priorit√© aux objets du titre s\'ils sont dans le texte',
                        '‚Ä¢ Formulations simples ("united states" pas "usa")',
                        '‚Ä¢ Une seule formulation par objet (pas trump + donald trump)',
                        '‚Ä¢ Concentration sur les plus saillants uniquement',
                        '',
                        '‚è∞ HORAIRES (6x/jour):',
                        '‚Ä¢ 00:16 UTC (19:16 EST veille) ‚Ä¢ 04:16 UTC (23:16 EST veille)',
                        '‚Ä¢ 08:16 UTC (03:16 EST) ‚Ä¢ 12:16 UTC (07:16 EST)',
                        '‚Ä¢ 16:16 UTC (11:16 EST) ‚Ä¢ 20:16 UTC (15:16 EST)',
                        '',
                        '‚è±Ô∏è TIMING: +13min apr√®s Glue Job (qui tourne √† xx:03 UTC)',
                        'üíæ M√âMOIRE: 10 GB (10240 MB)',
                        '‚è≥ TIMEOUT: 15 minutes'
                    ]
                },
                'salient-index': {
                    title: 'Refiner: radar-salient-index.R',
                    description: 'Calcule les indices de saillance absolus pour chaque objet extrait (SANS LLM - calculs purs).',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts - Table salient_headlines_objects',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Table salient_index',
                        '',
                        '‚öôÔ∏è TRAITEMENT (calculs math√©matiques):',
                        '‚Ä¢ S√©pare les objets CSV en lignes (separate_rows)',
                        '‚Ä¢ Normalise: lowercase + suppression ponctuation',
                        '‚Ä¢ Applique pond√©ration intra-m√©dia (headline_minutes / mean_time)',
                        '‚Ä¢ Applique pond√©ration inter-m√©dias (normalisation globale)',
                        '‚Ä¢ Calcule: absolute_normalized_index = n √ó total_pond_time_norm',
                        '‚Ä¢ Agr√®ge URLs, titres, bodies (JSON arrays)',
                        '',
                        'üìä DICTIONNAIRE POND√âRATION M√âDIA (mean_time en minutes):',
                        '‚Ä¢ CBC: 159.5 ‚Ä¢ CNN: 296.2 ‚Ä¢ CTV: 228.0 ‚Ä¢ FXN: 146.1',
                        '‚Ä¢ GAM: 325.9 ‚Ä¢ GN: 375.4 ‚Ä¢ JDM: 143.0 ‚Ä¢ LAP: 120.9',
                        '‚Ä¢ LED: 241.8 ‚Ä¢ MG: 241.4 ‚Ä¢ NP: 249.0 ‚Ä¢ RCI: 160.0',
                        '‚Ä¢ TTS: 221.3 ‚Ä¢ TVA: 125.0 ‚Ä¢ VS: 505.3',
                        '',
                        '‚è∞ HORAIRES (6x/jour):',
                        '‚Ä¢ 00:20 UTC (19:20 EST veille) ‚Ä¢ 04:20 UTC (23:20 EST veille)',
                        '‚Ä¢ 08:20 UTC (03:20 EST) ‚Ä¢ 12:20 UTC (07:20 EST)',
                        '‚Ä¢ 16:20 UTC (11:20 EST) ‚Ä¢ 20:20 UTC (15:20 EST)',
                        '',
                        '‚è±Ô∏è TIMING: +4min apr√®s radar-salient-objects (qui tourne √† xx:16 UTC)',
                        'üíæ M√âMOIRE: 10 GB (10240 MB)',
                        '‚è≥ TIMEOUT: 15 minutes',
                        '',
                        'üö´ PAS de LLM: Uniquement calculs statistiques'
                    ]
                },
                'headlines-issues': {
                    title: 'Refiner: radar-headlines-issues.R',
                    description: 'Classifie les headlines selon 12 cat√©gories d\'enjeux via deep learning, g√©n√®re 3 versions (quotidien, hebdomadaire, mensuel).',
                    details: [
                        'üì• SOURCE: <span class="badge-prod">PROD</span>/datawarehouse - Table r-media-headlines',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Tables headlines_issues_day/week/month',
                        '',
                        'ü§ñ MOD√àLE IA: Deep learning (CNN + LSTM)',
                        'üìö DICTIONNAIRE: dict-issues-two-categories (12 enjeux)',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Classifie chaque headline contre 12 cat√©gories',
                        '‚Ä¢ G√©n√®re scores de confiance par enjeu',
                        '‚Ä¢ Agr√®ge par jour/semaine/mois',
                        '‚Ä¢ Base pour issues-score et reflet',
                        '',
                        'üìã OUTPUTS:',
                        '‚Ä¢ headlines_issues_day - Quotidien (am/noon/pm)',
                        '‚Ä¢ headlines_issues_week - Hebdomadaire',
                        '‚Ä¢ headlines_issues_month - Mensuel',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ DAILY: 12:14, 16:14, 20:14 UTC',
                        '‚Ä¢ WEEKLY: 20:17 UTC',
                        '‚Ä¢ MONTHLY: 20:18 UTC',
                        '',
                        'üíæ M√âMOIRE: 4 GB (DAILY/WEEKLY), 10 GB (MONTHLY)',
                        '‚è≥ TIMEOUT: 10 minutes (DAILY/WEEKLY), 15 minutes (MONTHLY)',
                        '',
                        'üîó D√âPENDANCES: Utilise sorties radar-salient-objects'
                    ]
                },
                'issues-score': {
                    title: 'Refiner: radar-issues-score.R',
                    description: 'Agr√®ge les classifications d\'enjeux par p√©riode en proportions normalis√©es (somme=1.0).',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts - Tables headlines_issues_day/week/month',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Tables issues_score_day/week/month',
                        '',
                        '‚öôÔ∏è TRAITEMENT (calculs statistiques):',
                        '‚Ä¢ Compte mentions par enjeu',
                        '‚Ä¢ Normalise en proportions (0-1, somme=1.0)',
                        '‚Ä¢ Ajoute colonnes pour chaque enjeu',
                        '‚Ä¢ Agr√®ge par pass (am/noon/pm) pour daily',
                        '',
                        'üìä OUTPUTS:',
                        '‚Ä¢ issues_score_day - Quotidien (3 passes)',
                        '‚Ä¢ issues_score_week - Hebdomadaire',
                        '‚Ä¢ issues_score_month - Mensuel',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ DAILY: 12:09, 16:09, 20:09 UTC',
                        '‚Ä¢ WEEKLY: 20:11 UTC',
                        '‚Ä¢ MONTHLY: 20:14 UTC',
                        '',
                        'üíæ M√âMOIRE: 4 GB (DAILY/WEEKLY), 10 GB (MONTHLY)',
                        '‚è≥ TIMEOUT: 10 minutes (DAILY/WEEKLY), 15 minutes (MONTHLY)',
                        '',
                        'üö´ PAS de LLM: Uniquement calculs statistiques',
                        'üîó Utilis√© par: vitrine-graph-data pour frontend'
                    ]
                },
                'party-score': {
                    title: 'Refiner: radar-party-score.R',
                    description: 'Calcule la pertinence et le ton des partis politiques bas√©s sur les scores de saillance des objets extraits.',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts - Table salient_index',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Tables federal_parties_score_* et provincial_parties_score_*',
                        '',
                        'ü§ñ DICTIONNAIRES:',
                        '‚Ä¢ dict-political-parties-ca (6 partis f√©d√©raux: lpc, cpc, ndp, bq, gpc, ppc)',
                        '‚Ä¢ dict-political-parties-qc (5 partis provinciaux: caq, pq, plq, qs, pcq)',
                        '‚Ä¢ dict-sentiments (analyse de ton positif/n√©gatif)',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '1Ô∏è‚É£ MATCHING ROBUSTE:',
                        '   ‚Ä¢ Cross-join entre objets saillants et dictionnaires partis',
                        '   ‚Ä¢ Matching regex avec d√©limiteurs de mots (\\b pattern \\b)',
                        '   ‚Ä¢ √âvite faux positifs (ex: "tory" ne match pas "factory")',
                        '   ‚Ä¢ Garde premier match pour √©viter duplicats',
                        '',
                        '2Ô∏è‚É£ CALCUL DE PERTINENCE:',
                        '   ‚Ä¢ Agr√®ge scores de saillance (absolute_normalized_index) par parti/date',
                        '   ‚Ä¢ Assure pr√©sence de tous les partis (0 si non mentionn√©)',
                        '',
                        '3Ô∏è‚É£ ANALYSE DE TON:',
                        '   ‚Ä¢ D√©coupe bodies en phrases (√©vite splits sur "M.")',
                        '   ‚Ä¢ Applique dict-sentiments via ellipsetxt::run_dictionary',
                        '   ‚Ä¢ Calcule ton net: (pos + neg_pos - neg - neg_neg) / mots_phrase',
                        '   ‚Ä¢ Moyenne par parti et date',
                        '',
                        '4Ô∏è‚É£ POND√âRATION TEMPORELLE:',
                        '   ‚Ä¢ Day: poids [1, 0.25, 0.20, 0.15, 0.10, 0.05, 0.02] sur 7 jours',
                        '   ‚Ä¢ Week: poids [1, 0.85, 0.7, 0.55, 0.4, 0.25, 0.10] sur 7 jours',
                        '   ‚Ä¢ Month: d√©croissance lin√©aire 1‚Üí0.1 sur 30 jours',
                        '   ‚Ä¢ weighted_mentions = sum(salience √ó weight)',
                        '   ‚Ä¢ weighted_tone = sum(tone √ó weight)',
                        '',
                        '5Ô∏è‚É£ OUTPUTS:',
                        '   ‚Ä¢ 6 tables: federal/provincial √ó day/week/month',
                        '   ‚Ä¢ Colonnes: party, weighted_mentions, weighted_tone, date_utc, date_montreal_tz',
                        '   ‚Ä¢ Colonne pass (am/noon/pm) uniquement pour daily',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ DAILY: 12:18, 16:18, 20:18 UTC (pass=am/noon/pm)',
                        '‚Ä¢ WEEKLY: 20:20 UTC',
                        '‚Ä¢ MONTHLY: 20:22 UTC',
                        '',
                        'üíæ M√âMOIRE: 10 GB (tous)',
                        '‚è≥ TIMEOUT: 15 minutes (tous)',
                        '',
                        'üîó D√âPENDANCES: N√©cessite salient_index g√©n√©r√© par radar-salient-index',
                        'üîó Utilis√© par: vitrine-graph-data, dashboard politique'
                    ]
                },
                'reflet-daily-weekly': {
                    title: 'Refiner: radar-reflet-daily-weekly.R',
                    description: 'G√©n√®re des synth√®ses textuelles (LLM) quotidiennes et hebdomadaires par enjeu via GPT-4o.',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts - Tables salient_headlines_objects, headlines_issues_day/week',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Tables reflet_day, reflet_week',
                        '',
                        'ü§ñ MOD√àLE IA: GPT-4o (OpenAI) via ellipsellm',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Lit headlines class√©s par enjeu',
                        '‚Ä¢ Pour chaque enjeu principal (non-nul):',
                        '‚Ä¢   ‚Ä¢ S√©lectionne headlines pertinents avec scores',
                        '‚Ä¢   ‚Ä¢ G√©n√®re synth√®se LLM: liste de points cl√©s',
                        '‚Ä¢   ‚Ä¢ Format: bullet list de 3-5 points',
                        '‚Ä¢ G√©n√®re 3 versions: am, noon, pm (daily) et 1 (weekly)',
                        '‚Ä¢ Envoie notifications Slack',
                        '',
                        'üìã OUTPUTS:',
                        '‚Ä¢ reflet_day - Quotidien (3 passes: am/noon/pm)',
                        '‚Ä¢ reflet_week - Hebdomadaire (1 fois)',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ DAILY: 12:25, 16:25, 20:25 UTC',
                        '‚Ä¢ WEEKLY: 20:28 UTC',
                        '',
                        'üíæ M√âMOIRE: 10 GB (tous)',
                        '‚è≥ TIMEOUT: 15 minutes (tous)',
                        '',
                        'üîó D√âPENDANCES: Utilise headlines_issues class√©s par radar-headlines-issues'
                    ]
                },
                'reflet-monthly': {
                    title: 'Refiner: radar-reflet-monthly.R',
                    description: 'G√©n√®re des synth√®ses textuelles (LLM) mensuelles par enjeu via GPT-4o.',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts - Tables headlines_issues_month',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Table reflet_month',
                        '',
                        'ü§ñ MOD√àLE IA: GPT-4o (OpenAI) via ellipsellm',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Agr√®ge headlines du mois par enjeu',
                        '‚Ä¢ M√™me logique que reflet-daily-weekly',
                        '‚Ä¢ Synth√©tise l\'ensemble du mois par enjeu',
                        '‚Ä¢ G√©n√®re 1 fois par mois (ou hors-horaire)',
                        '‚Ä¢ Envoie notification Slack',
                        '',
                        'üìã OUTPUT:',
                        '‚Ä¢ reflet_month - Mensuel',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ MONTHLY: 20:30 UTC - ex√©cution quotidienne, g√©n√®re si donn√©es nouvelles',
                        '',
                        'üíæ M√âMOIRE: 10 GB',
                        '‚è≥ TIMEOUT: 15 minutes'
                    ]
                },
                'headline-of-headlines': {
                    title: 'Refiner: radar-headline-of-headlines.R',
                    description: 'G√©n√®re une "Une des Unes" synth√©tique (headline principal) pour chaque p√©riode de 4h via LLM.',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts - Table salient_headlines_objects',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Table headline_of_headlines',
                        '',
                        'ü§ñ MOD√àLE IA: GPT-4o (OpenAI) via ellipsellm',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Identifie objets les plus saillants du bloc 4h',
                        '‚Ä¢ D√©termine l\'enjeu principal de la p√©riode',
                        '‚Ä¢ G√©n√®re LLM: titre, texte (2-3 lignes), liste objets',
                        '‚Ä¢ S√©lectionne meilleur headline de r√©f√©rence',
                        '',
                        'üìã OUTPUT:',
                        '‚Ä¢ headline_of_headlines - Une synth√©s√©e par bloc 4h',
                        '',
                        '‚è∞ HORAIRES (6x/jour):',
                        '‚Ä¢ 00:28 UTC (19:28 EST veille) ‚Ä¢ 04:28 UTC (23:28 EST veille)',
                        '‚Ä¢ 08:28 UTC (03:28 EST) ‚Ä¢ 12:28 UTC (07:28 EST)',
                        '‚Ä¢ 16:28 UTC (11:28 EST) ‚Ä¢ 20:28 UTC (15:28 EST)',
                        '',
                        '‚è±Ô∏è TIMING: +8min apr√®s salient-index',
                        'üíæ M√âMOIRE: 10 GB',
                        '‚è≥ TIMEOUT: 15 minutes'
                    ]
                },
                'hot20': {
                    title: 'Refiner: radar-hot-20.R',
                    description: 'G√©n√®re le TOP 20 des headlines les plus saillants de la semaine pour 3 pays avec visualisations.',
                    details: [
                        'üì• SOURCE:',
                        '‚Ä¢ <span class="badge-dev">DEV</span>/datamarts - Table salient_headlines_objects (filtr√©e sur la semaine, recalcule les indices absolus)',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - Table hot_20_headlines',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Agr√®ge salient_headlines_objects sur la semaine compl√®te (recalcule indices absolus pond√©r√©s)',
                        '‚Ä¢ Calcule scores de saillance totaux par objet',
                        '‚Ä¢ G√©n√®re TOP 20 pour QC, CAN, USA s√©par√©ment',
                        '‚Ä¢ Ajoute colonnes variation: "Nouveau", "‚ñ≤2", "‚ñº1", "Retour", "Stable"',
                        '‚Ä¢ G√©n√®re visualisations GT (PNG + HTML interactif)',
                        '‚Ä¢ Upload images S3 + HTML',
                        '‚Ä¢ Envoie √† Slack avec screenshots',
                        '',
                        'üìã OUTPUT:',
                        '‚Ä¢ hot_20_headlines - Classement hebdomadaire',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ WEEKLY: Vendredi 16:30 UTC',
                        '',
                        'üíæ M√âMOIRE: 10 GB + 5 GB ephemeral storage (Athena)',
                        '‚è≥ TIMEOUT: 15 minutes'
                    ]
                },
                'sonar': {
                    title: 'Refiner: sonar.R',
                    description: 'ETL qualit√© : agr√®ge frontpages + headlines de 14 jours en m√©triques structur√©es pour monitoring.',
                    details: [
                        'üì• SOURCES:',
                        '‚Ä¢ <span class="badge-prod">PROD</span>/datawarehouse - Table r-media-frontpages',
                        '‚Ä¢ <span class="badge-prod">PROD</span>/datawarehouse - Table r-media-headlines',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts (sonar) - Table data_quality_14_days',
                        '',
                        '‚öôÔ∏è TRAITEMENT (6 m√©triques par m√©dia/jour):',
                        '‚Ä¢ fp_* = Nombre de frontpages scrap√©es',
                        '‚Ä¢ uh_* = Nombre de Unes uniques (unique headlines)',
                        '‚Ä¢ body_* = Nombre articles avec texte (body)',
                        '‚Ä¢ title_* = Nombre articles avec titre',
                        '‚Ä¢ author_* = Nombre articles avec auteur',
                        '‚Ä¢ words_* = Total mots (articles avec body)',
                        '',
                        'üìä STRUCTURE TABLE:',
                        '‚Ä¢ 1 ligne = 1 m√©dia (CBC, CTV, GAM, GN, JDM, LAP, LED, MG, NP, RCI, TTS, TVA, VS)',
                        '‚Ä¢ Colonnes: media + 6√ó14 colonnes (fp_YYYYMMDD, uh_YYYYMMDD, etc.)',
                        '‚Ä¢ NA ‚Üí 0 (pas de donn√©es = pas d\'articles)',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ DAILY: Quotidien (donn√©es du jour +1)',
                        '',
                        'üíæ M√âMOIRE: 5 GB',
                        '‚è≥ TIMEOUT: 10 minutes'
                    ]
                },
                'sonar-heatmaps': {
                    title: 'Refiner: sonar-heatmaps.R',
                    description: 'G√©n√®re 6 heatmaps de monitoring pour surveillance qualit√© donn√©es SONAR.',
                    details: [
                        'üì• SOURCE: <span class="badge-dev">DEV</span>/datamarts (sonar) - Table data_quality_14_days',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - 6 PNG heatmaps',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Charge table sonar (14 jours de m√©triques)',
                        '‚Ä¢ G√©n√®re 6 heatmaps (m√©dia √ó jour):',
                        '  1. Frontpages scrap√©es (fp_*)',
                        '  2. Unes uniques (uh_*)',
                        '  3. Articles avec texte (body_*)',
                        '  4. Articles avec titre (title_*)',
                        '  5. Articles avec auteur (author_*)',
                        '  6. Total mots (words_*)',
                        '‚Ä¢ Format: gradient blanc ‚Üí vert (GitHub style)',
                        '‚Ä¢ Upload sur S3 (datalake) + Slack #02_radar_plus_sonar',
                        '',
                        'üìä OUTPUTS:',
                        '‚Ä¢ 6 PNG files ‚Üí S3 datalake (sonar-heatmaps)',
                        '‚Ä¢ Slack posts ‚Üí #02_radar_plus_sonar channel',
                        '',
                        '‚è∞ HORAIRES:',
                        '‚Ä¢ WEEKLY: Mercredi 09:00 UTC',
                        '',
                        'üíæ M√âMOIRE: 5 GB',
                        '‚è≥ TIMEOUT: 15 minutes'
                    ]
                },
                'vitrine-graph-data': {
                    title: 'Refiner: vitrine-graph-data.R',
                    description: 'Publie TOUTES les donn√©es finales en JSON vers S3 pour le frontend Vitrine.',
                    details: [
                        'üì• SOURCES: <span class="badge-dev">DEV</span>/datamarts - Lectures compl√®tes de TOUTES les tables',
                        'üì§ OUTPUT: <span class="badge-dev">DEV</span>/datamarts - JSON sur S3',
                        '',
                        '‚öôÔ∏è TRAITEMENT:',
                        '‚Ä¢ Agr√®ge TOUTES les tables finales',
                        '‚Ä¢ Convertit en JSON propre (normalis√©)',
                        '‚Ä¢ Optimise pour API frontend',
                        '‚Ä¢ Upload 13 fichiers JSON sur S3',
                        '‚Ä¢ Structure: s3://vitrinedemocratique/data/refined/{period}/{table}.json',
                        '',
                        'üìã OUTPUTS (13 fichiers JSON):',
                        '‚Ä¢ issues_score_{day|week|month}',
                        '‚Ä¢ federal_parties_score_{day|week|month}',
                        '‚Ä¢ provincial_parties_score_{day|week|month}',
                        '‚Ä¢ reflet_{day|week|month}',
                        '‚Ä¢ headline_of_headlines',
                        '',
                        '‚è∞ HORAIRES (5x/jour):',
                        '‚Ä¢ 04:39 UTC (23:39 EST veille) ‚Ä¢ 08:39 UTC (03:39 EST)',
                        '‚Ä¢ 12:39 UTC (07:39 EST) ‚Ä¢ 16:39 UTC (11:39 EST) ‚Ä¢ 20:39 UTC (15:39 EST)',
                        '',
                        'üíæ M√âMOIRE: 10 GB + 5 GB ephemeral storage',
                        '‚è≥ TIMEOUT: 15 minutes'
                    ]
                }
            },
            dicts: {
                'issues': {
                    title: 'Dictionnaire: dict-issues-two-categories',
                    description: 'D√©finit les 12 cat√©gories d\'enjeux politiques utilis√©es pour classifier les headlines.',
                    details: [
                        '1. Economy and Labour (√âconomie et travail)',
                        '2. Rights, Liberties, Minorities & Discrimination',
                        '3. Health and Social Services',
                        '4. Public Lands and Agriculture',
                        '5. Immigration',
                        '6. Education',
                        '7. Environment and Energy',
                        '8. Law and Crime',
                        '9. International Affairs and Defense',
                        '10. Technology',
                        '11. Governments and Governance',
                        '12. Culture and Nationalism'
                    ]
                },
                'parties-ca': {
                    title: 'Dictionnaire: dict-political-parties-ca',
                    description: 'Liste des partis politiques f√©d√©raux canadiens √† suivre.',
                    details: [
                        'Parti Lib√©ral du Canada',
                        'Parti Conservateur du Canada',
                        'Nouveau Parti D√©mocratique (NPD)',
                        'Bloc Qu√©b√©cois',
                        'Parti Vert du Canada',
                        'Parti Populaire du Canada (PPC)',
                        'Inclut noms officiels, abr√©viations, leaders'
                    ]
                },
                'parties-qc': {
                    title: 'Dictionnaire: dict-political-parties-qc',
                    description: 'Liste des partis politiques provinciaux qu√©b√©cois.',
                    details: [
                        'Coalition Avenir Qu√©bec (CAQ)',
                        'Parti Lib√©ral du Qu√©bec (PLQ)',
                        'Parti Qu√©b√©cois (PQ)',
                        'Qu√©bec Solidaire (QS)',
                        'Parti Conservateur du Qu√©bec (PCQ)',
                        'Inclut noms officiels, abr√©viations, leaders'
                    ]
                },
                'sentiments': {
                    title: 'Dictionnaire: dict-sentiments',
                    description: 'Dictionnaire de mots et expressions avec valences de sentiment pour analyse de ton.',
                    details: [
                        'Mots positifs avec scores (+1 √† +5)',
                        'Mots n√©gatifs avec scores (-1 √† -5)',
                        'Expressions idiomatiques',
                        'Modificateurs d\'intensit√©',
                        'Contexte fran√ßais/anglais',
                        'Utilis√© par radar-party-score.R pour calculer le ton'
                    ]
                }
            },
            sources: {
                'r-media-headlines': {
                    title: 'Source: r-media-headlines',
                    description: 'Glue Job Python ETL qui transforme les donn√©es de scraping en table datawarehouse',
                    details: [
                        'üî¥ Type: Glue Job Python ETL (pas un refiner R)',
                        'üìç Localisation: Code Python externe au repo refiners',
                        '‚è∞ Fr√©quence: 6x/jour (00:03, 04:03, 08:03, 12:03, 16:03, 20:03 UTC)',
                        'üéØ Fonction: Job ETL qui transforme les donn√©es brutes de scraping',
                        '',
                        'üìã Processus ETL (Extract-Transform-Load):',
                        '‚Ä¢ EXTRACT: Lit les donn√©es des scrapers (qui tournent toutes les 10 min)',
                        '‚Ä¢ TRANSFORM: Nettoie HTML, normalise texte, calcule dur√©es de Une',
                        '‚Ä¢ LOAD: √âcrit dans table datawarehouse r-media-headlines',
                        '',
                        'üîÑ Architecture:',
                        '‚Üí Scrapers Python (10 min) capturent headlines en temps r√©el',
                        '‚Üí Glue Job ETL (6x/jour) agr√®ge et transforme ces donn√©es',
                        '‚Üí Table r-media-headlines = donn√©es nettoy√©es et pr√™tes',
                        '',
                        'üí° Pourquoi "Chargeur ETL"?',
                        '‚Üí C\'est un Glue Job Python (pas un refiner R)',
                        '‚Üí Point d\'entr√©e du syst√®me (chargement + transformation initiale)',
                        '‚Üí ETL = Extract (scrapers) ‚Üí Transform (Glue) ‚Üí Load (datawarehouse)',
                        '‚Üí Diff√©rent des refiners qui transforment des donn√©es d√©j√† charg√©es',
                        '',
                        'üïê Ex√©cution: 6x/jour (00:03, 04:03, 08:03, 12:03, 16:03, 20:03 UTC)',
                        'üìä Sortie: Table r-media-headlines dans datawarehouse'
                    ]
                },
                'r-media-frontpages': {
                    title: 'Glue Job Python: r-media-frontpages',
                    description: 'Job Python AWS Glue qui scrape les frontpages des m√©dias pour SONAR',
                    details: [
                        'Scrape les pages d\'accueil de chaque m√©dia toutes les 4h',
                        'Capture des screenshots et m√©tadonn√©es',
                        'Utilis√© exclusivement par le pipeline SONAR',
                        'Class√© "Chargeur ETL" car c\'est un Glue Job Python (pas un Refiner R)',
                        'Ex√©cution: 6x/jour en parall√®le avec r-media-headlines',
                        'Output: Table Glue brute (non-datamart)'
                    ]
                }
            },
            outputs: {
                'hot20-files': {
                    title: 'Hot 20 - Fichiers PNG et HTML',
                    description: '6 fichiers g√©n√©r√©s chaque vendredi √† 17:00 UTC (12:00 EST)',
                    image: 'images_vitrine/hot20.png',
                    details: [
                        'üìä 3 fichiers PNG (visualisations):',
                        '‚Ä¢ hot20_qc.png - TOP 20 Qu√©bec',
                        '‚Ä¢ hot20_can.png - TOP 20 Canada',
                        '‚Ä¢ hot20_usa.png - TOP 20 USA',
                        '',
                        'üåê 3 fichiers HTML (tableaux interactifs):',
                        '‚Ä¢ hot20_qc.html - Version interactive QC',
                        '‚Ä¢ hot20_can.html - Version interactive CAN',
                        '‚Ä¢ hot20_usa.html - Version interactive USA',
                        '',
                        'üìç Localisation: Publi√©s sur S3',
                        '‚è∞ G√©n√©ration: Vendredis 17:00 UTC (12:00 EST)',
                        'üé® Format: Tables GT (Grammar of Tables) avec styling professionnel'
                    ]
                },
                'slack-hot20': {
                    title: 'Notifications Slack - Hot 20',
                    description: 'Publication hebdomadaire dans le canal Slack #hot20',
                    details: [
                        'üì¢ Canal: #hot20',
                        '‚è∞ Fr√©quence: Chaque vendredi 17:00 UTC (12:00 EST)',
                        'üìé Contenu envoy√©:',
                        '‚Ä¢ Message r√©capitulatif de la semaine',
                        '‚Ä¢ 3 images PNG attach√©es (QC, CAN, USA)',
                        '‚Ä¢ Liens vers les tableaux HTML interactifs',
                        '',
                        'üéØ Audience: √âquipe interne + analystes politiques',
                        'üí° But: Suivi hebdomadaire des headlines les plus saillants'
                    ]
                },
                'sonar-heatmaps': {
                    title: 'SONAR - Heatmaps de Qualit√©',
                    description: 'Visualisations de la qualit√© du scraping sur 14 jours',
                    image: 'images_vitrine/sonar.png',
                    details: [
                        'üìä Fichiers g√©n√©r√©s:',
                        '‚Ä¢ sonar_heatmap.png - Image statique',
                        '‚Ä¢ sonar_heatmap.html - Version interactive',
                        '',
                        'üìà Contenu visualis√©:',
                        '‚Ä¢ Qualit√© du scraping par m√©dia (lignes)',
                        '‚Ä¢ √âvolution sur 14 derniers jours (colonnes)',
                        '‚Ä¢ Code couleur: vert (bon) ‚Üí rouge (probl√®me)',
                        '',
                        'üé® M√©triques affich√©es:',
                        '‚Ä¢ Taux de succ√®s du scraping',
                        '‚Ä¢ Compl√©tude des donn√©es',
                        '‚Ä¢ Nombre d\'erreurs',
                        '‚Ä¢ Score qualit√© global',
                        '',
                        '‚è∞ G√©n√©ration: Mercredis 12:30 UTC (07:30 EST)',
                        'üìç Localisation: Publi√©s sur S3'
                    ]
                },
                'slack-sonar': {
                    title: 'Notifications Slack - SONAR',
                    description: 'Alertes hebdomadaires de monitoring qualit√©',
                    details: [
                        'üì¢ Canal: #sonar',
                        '‚è∞ Fr√©quence: Mercredis 12:30 UTC (07:30 EST)',
                        'üìé Contenu envoy√©:',
                        '‚Ä¢ Rapport de qualit√© sur 14 jours',
                        '‚Ä¢ Heatmap PNG attach√©e',
                        '‚Ä¢ Lien vers heatmap HTML interactive',
                        '‚Ä¢ Alertes sur m√©dias probl√©matiques',
                        '',
                        'üö® Alertes automatiques si:',
                        '‚Ä¢ Score qualit√© < seuil d√©fini',
                        '‚Ä¢ Augmentation soudaine des erreurs',
                        '‚Ä¢ M√©dia non-scraped pendant > 24h',
                        '',
                        'üéØ Audience: √âquipe technique DevOps',
                        'üí° But: Monitoring proactif de la sant√© du syst√®me'
                    ]
                },
                'all-final-tables': {
                    title: 'Toutes les Tables Finales',
                    description: 'Collection compl√®te des tables datamart pour publication',
                    details: [
                        'üìã Tables incluses:',
                        '',
                        'üìä Issues Score (3 tables):',
                        '‚Ä¢ issues_score_day - Scores quotidiens par enjeu',
                        '‚Ä¢ issues_score_week - Agr√©gation hebdomadaire',
                        '‚Ä¢ issues_score_month - Agr√©gation mensuelle',
                        '',
                        'üèõÔ∏è Party Scores (6 tables):',
                        '‚Ä¢ federal_parties_score_day/week/month',
                        '‚Ä¢ provincial_parties_score_day/week/month',
                        '',
                        'üí≠ Reflet (3 tables):',
                        '‚Ä¢ reflet_day - Synth√®ses quotidiennes LLM',
                        '‚Ä¢ reflet_week - Synth√®ses hebdomadaires',
                        '‚Ä¢ reflet_month - Synth√®ses mensuelles',
                        '',
                        'üì∞ Headline of Headlines (1 table):',
                        '‚Ä¢ headline_of_headlines - Une des Unes par p√©riode 4h',
                        '',
                        'üéØ Total: 13 tables ‚Üí 13 fichiers JSON publi√©s'
                    ]
                },
                'json-files': {
                    title: '13 Fichiers JSON Publi√©s',
                    description: 'Donn√©es transform√©es en JSON pour le frontend',
                    details: [
                        'üìÅ Structure S3:',
                        's3://bucket/data/refined/',
                        '',
                        'üìÇ day/ (4 fichiers):',
                        '‚Ä¢ issues_score_day.json',
                        '‚Ä¢ federal_parties_score_day.json',
                        '‚Ä¢ provincial_parties_score_day.json',
                        '‚Ä¢ reflet_day.json',
                        '',
                        'üìÇ week/ (4 fichiers):',
                        '‚Ä¢ issues_score_week.json',
                        '‚Ä¢ federal_parties_score_week.json',
                        '‚Ä¢ provincial_parties_score_week.json',
                        '‚Ä¢ reflet_week.json',
                        '',
                        'üìÇ month/ (5 fichiers):',
                        '‚Ä¢ issues_score_month.json',
                        '‚Ä¢ federal_parties_score_month.json',
                        '‚Ä¢ provincial_parties_score_month.json',
                        '‚Ä¢ reflet_month.json',
                        '‚Ä¢ headline_of_headlines.json',
                        '',
                        'üîÑ Mise √† jour: 5x/jour (+36min apr√®s Glue)',
                        'üåê Consomm√©s par: Frontend React du site vitrine'
                    ]
                },
                'frontend-vitrine': {
                    title: 'Frontend Vitrine d√©mocratique',
                    description: 'Site web public affichant toutes les analyses politiques',
                    details: [
                        'üåê Site web: Vitrine d√©mocratique',
                        'üîó URL DEV: <a href="https://dev.vitrinedemocratique.com/beta.html" target="_blank" style="color: #4A90E2; font-weight: bold;">https://dev.vitrinedemocratique.com/beta.html</a>',
                        '',
                        'üìä Pages disponibles:',
                        '‚Ä¢ Dashboard principal avec KPIs',
                        '‚Ä¢ Vue par enjeux (12 cat√©gories)',
                        '‚Ä¢ Vue par partis (f√©d√©ral + provincial)',
                        '‚Ä¢ Synth√®ses Reflet (quotidiennes/hebdo/mensuelles)',
                        '‚Ä¢ Une des Unes (headline of headlines)',
                        '',
                        'üîÑ Donn√©es:',
                        '‚Ä¢ Lectures depuis S3 (13 fichiers JSON)',
                        '‚Ä¢ Mise √† jour: 5x/jour via vitrine-graph-data.R',
                        '‚Ä¢ Latence: ~40 minutes apr√®s scraping',
                        '',
                        'üé® Technologie:',
                        '‚Ä¢ Frontend: React + TypeScript',
                        '‚Ä¢ Graphiques: Recharts / D3.js',
                        '‚Ä¢ Hosting: CloudFront + S3',
                        '',
                        'üéØ Audience: Grand public + analystes politiques'
                    ]
                }
            }
        };

        // Filter controls
        const buttons = document.querySelectorAll('.btn');
        const pipelines = document.querySelectorAll('.pipeline');

        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                const filter = btn.dataset.filter;
                buttons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                pipelines.forEach(pipeline => {
                    if (filter === 'all' || pipeline.dataset.pipeline === filter) {
                        pipeline.classList.remove('hidden');
                    } else {
                        pipeline.classList.add('hidden');
                    }
                });
            });
        });

        // Node type filter controls - met en √©vidence le type s√©lectionn√©
        const nodeButtons = document.querySelectorAll('.btn-node');
        let selectedNodeType = null;

        nodeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const nodeType = btn.dataset.nodeFilter;

                // Si on clique sur le m√™me bouton, on d√©s√©lectionne (reset)
                if (selectedNodeType === nodeType) {
                    selectedNodeType = null;
                    nodeButtons.forEach(b => b.classList.add('active-node'));
                    // Remettre tous les nodes √† opacit√© normale
                    document.querySelectorAll('.node').forEach(node => {
                        node.style.opacity = '1';
                    });
                } else {
                    // S√©lectionner le nouveau type
                    selectedNodeType = nodeType;
                    // Mettre √† jour les boutons
                    nodeButtons.forEach(b => {
                        if (b.dataset.nodeFilter === nodeType) {
                            b.classList.add('active-node');
                        } else {
                            b.classList.remove('active-node');
                        }
                    });

                    // Mettre en √©vidence seulement le type s√©lectionn√©
                    document.querySelectorAll('.node').forEach(node => {
                        const nodeClass = node.className.split(' ').find(c => c.startsWith('node-'));
                        if (nodeClass) {
                            const type = nodeClass.replace('node-', '');
                            if (type === nodeType) {
                                node.style.opacity = '1';
                            } else {
                                node.style.opacity = '0.2';
                            }
                        }
                    });
                }
            });
        });

        // Collapsible pipelines - simple approach
        document.querySelectorAll('.pipeline-header').forEach(header => {
            header.style.cursor = 'pointer';
            header.addEventListener('click', function(e) {
                // Ne toggle que si on clique sur le toggle-icon ou directement sur le header
                if (e.target.classList.contains('toggle-icon') || e.target === this) {
                    this.closest('.pipeline').classList.toggle('collapsed');
                }
            });
        });

        // Modal functionality
        const modal = document.getElementById('modal');
        const modalBody = document.getElementById('modal-body');
        const closeBtn = document.querySelector('.close-modal');

        function showModal(type, key) {
            console.log('üì¢ showModal appel√© - type:', type, 'key:', key);
            const data = modalData[type][key];
            if (!data) {
                console.error('‚ùå Aucune donn√©e trouv√©e pour:', type, key);
                return;
            }
            console.log('‚úÖ Donn√©es trouv√©es:', data.title);

            let html = `<h2>${data.title}</h2>`;
            html += `<p><strong>${data.description}</strong></p>`;

            if (data.image) {
                html += `<div style="text-align: center; margin: 20px 0;"><img src="${data.image}" style="max-width: 100%; max-height: 500px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"/></div>`;
            }

            if (data.columns) {
                html += '<h3>üìã Colonnes de la table:</h3><ul>';
                data.columns.forEach(col => {
                    html += `<li>${col}</li>`;
                });
                html += '</ul>';
            }

            if (data.details) {
                html += '<h3>‚ÑπÔ∏è D√©tails:</h3><ul>';
                data.details.forEach(detail => {
                    html += `<li>${detail}</li>`;
                });
                html += '</ul>';
            }

            modalBody.innerHTML = html;
            modal.classList.add('show');
            console.log('‚úÖ Modal affich√©e!');
        }

        closeBtn.addEventListener('click', () => {
            modal.classList.remove('show');
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('show');
            }
        });

        // Add click handlers to nodes
        const tableNodes = document.querySelectorAll('[data-table]');
        console.log('üìä Nodes [data-table] trouv√©s:', tableNodes.length);
        tableNodes.forEach(node => {
            node.addEventListener('click', (e) => {
                console.log('üñ±Ô∏è Clic d√©tect√© sur table:', node.dataset.table);
                showModal('tables', node.dataset.table);
            });
        });

        const refinerNodes = document.querySelectorAll('[data-refiner]');
        console.log('‚öôÔ∏è Nodes [data-refiner] trouv√©s:', refinerNodes.length);
        refinerNodes.forEach(node => {
            node.addEventListener('click', (e) => {
                console.log('üñ±Ô∏è Clic d√©tect√© sur refiner:', node.dataset.refiner);
                showModal('refiners', node.dataset.refiner);
            });
        });

        document.querySelectorAll('[data-dict]').forEach(node => {
            node.addEventListener('click', () => {
                showModal('dicts', node.dataset.dict);
            });
        });

        const sourceNodes = document.querySelectorAll('[data-source]');
        console.log('üì° Nodes [data-source] trouv√©s:', sourceNodes.length);
        sourceNodes.forEach(node => {
            node.addEventListener('click', (e) => {
                console.log('üñ±Ô∏è Clic d√©tect√© sur source:', node.dataset.source);
                showModal('sources', node.dataset.source);
            });
        });

        const outputNodes = document.querySelectorAll('[data-output]');
        console.log('üì§ Nodes [data-output] trouv√©s:', outputNodes.length);
        outputNodes.forEach(node => {
            node.addEventListener('click', (e) => {
                console.log('üñ±Ô∏è Clic d√©tect√© sur output:', node.dataset.output);
                showModal('outputs', node.dataset.output);
            });
        });
        
        console.log('‚úÖ Tous les event listeners attach√©s!');
        }); // Fin DOMContentLoaded
    </script>
</body>
</html>
